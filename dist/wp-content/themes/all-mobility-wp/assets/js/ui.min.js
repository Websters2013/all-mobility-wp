!function(){$(function(){$(".popup").each(function(){new o($(this))})});var o=function(o){var n=this,t=40,i=$(".popup__open"),e=o,p=e.find(".popup__close, .popup__cancel"),c=e.find(".popup__wrap"),u=e.find(".popup__content"),s=$("html"),d=$(window),a=setTimeout(function(){},1),f=function(){d.height()-2*t-c.height()>0?c.css({top:(d.height()-2*t-c.height())/2}):c.css({top:0})},r=function(){var o,n=document.createElement("div");return n.className="popup__scrollbar-measure",document.body.appendChild(n),o=n.offsetWidth-n.clientWidth,document.body.removeChild(n),o},l=function(){e.css({overflowY:"hidden"}),s.css({overflowY:"auto",paddingRight:0}),e.removeClass("popup_opened"),e.addClass("popup_hide"),a=setTimeout(function(){e.css({overflowY:"auto"}),e.removeClass("popup_hide")},300)},h=function(){e[0].obj=n,_()},_=function(){d.on({resize:function(){f()}}),i.on({click:function(){return v($(this).attr("data-popup")),!1}}),u.find(">div").on({click:function(o){o.stopPropagation()}}),e.on({click:function(){return l(),!1}}),p.on({click:function(){return l(),!1}})},v=function(o){m(o),s.css({overflowY:"hidden",paddingRight:r()}),e.addClass("popup_opened"),f()},m=function(o){var n=u.filter(".popup__"+o);u.css({display:"none"}),n.css({display:"block"})};h()}}();
!function(){$(function(){$("select").each(function(){new e({obj:$(this),optionType:1,showType:2})})});var e=function(e){var t,n,i=this,o=e.obj,s=e.optionType||0,c=e.showType||0,a=e.visible||5,l=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),d=$('<span class="websters-select__item"></span>'),p=$('<div class="websters-select"></div>'),r=$(window),f=$("body"),u=!1,h=function(){var e="";o.css({opacity:0}),o.wrap(p),p=o.parent(),p.append('<div class="websters-select__arrow"></div>'),o.before(d),o.find("option").each(function(){var t=$(this);"selected"==t.attr("selected")&&(e=t.text())}),""==e&&(e=o.find("option").eq(0).text()),d.text(e)},v=function(){u=!1,c?1==c?t.stop(!0,!1).slideUp(300,function(){t.remove()}):2==c&&t.stop(!0,!1).fadeOut(300,function(){t.remove()}):t.css({display:"none"}),p.removeClass("websters-select_opened")},b=function(){o[0].obj=i,h(),g(),w()},w=function(){o.on("change",function(){d.text($(this).find("option:selected").text())}),$(document).on("change","select",function(){$(this).prev().text($(this).find("option:selected").text())}),1!=s||l||p.on({click:function(e){e.stopPropagation(),u?v():y()}}),f.on({click:function(){u&&v()}}),r.on({scroll:function(){u&&v()}})},g=function(){!s||l?x():1==s&&_()},_=function(){p.addClass("websters-select_custom")},x=function(){p.addClass("websters-select_mobile")},y=function(){var e=$("select"),i=$("<ul></ul>"),s=(r.scrollTop(),p.offset()),l=0,d=o.find("option:selected").index(),h=Math.round(1e3*Math.random());e.each(function(){this!==o[0]&&this.obj.checkOpened()&&this.obj.close()}),u&&t.remove(),u=!0,t=$('<div class="websters-select__popup" id="websters-select__popup'+h+'"></div>'),o.find("option").each(function(e){var t=$(this);e==d?i.append('<li class="active">'+t.text()+"</li>"):i.append("<li>"+t.text()+"</li>")}),t.append(i),f.append(t),p.addClass("websters-select_opened"),t.css({width:p.outerWidth(),left:s.left,top:s.top+p.outerHeight()}),l=t.outerHeight(),l>t.find("li").eq(0).outerHeight()*a&&(t.height(t.find("li").eq(0).outerHeight()*a),n=t.perfectScrollbar()),1==c?(t.css({display:"none"}),t.slideDown(300)):2==c&&(t.css({opacity:.1}),t.animate({opacity:1},300)),t.find("li").on({click:function(e){var t=$(this).index();e.stopPropagation(),o.val(o.find("option").eq(t).attr("value")),o.trigger("change"),v()}})};i.checkOpened=function(){return u},i.close=function(){v()},b()}}();
!function(){$(function(){$(".search").each(function(){new e($(this))})});var e=function(e){var t=e,i=t.find("input[type=search]"),a=new XMLHttpRequest,s=t.data("path"),n=0,o=0,r=i.val(),c=t.find(".search__result"),l=function(){i.on({keyup:function(e){if($(window).width()>=1024)switch(e.keyCode){case 13:0==c.find(".search__found li").filter(".active").length&&t.find("form").submit();break;case 32:case 27:case 37:case 38:case 39:case 40:break;default:var i=$(this).val();i.length>=t.data("symbols")?u($(this),i.length):""==$(this).val()&&(c.removeClass("visible"),n=0)}},keydown:function(e){if(c.find(".search__found").html(""),c.find(".top-products").html(""),n=0,$(window).width()>=1024)switch(e.keyCode){case 13:return 0==c.find(".search__found li").filter(".active").length?window.location.href=t.data("action"):window.location.href=c.find(".search__found li").filter(".active").find("a").attr("href"),!1;case 27:return c.remove(),n=0,!1;case 38:case 40:e.preventDefault(),o>0&&(d(e.keyCode),n==o&&(n=0))}}}),$("html").click(function(){c.removeClass("visible"),n=0}),$(document).on("click","body",function(e){e=e||window.event,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}),$(document).on("click",".search__found li",function(){var e=$(this),t=e.find("a").text();i.val(t),c.removeClass("visible"),n=0}),$(document).on("keydown",".search__found li",function(e){switch(e.keyCode){case 13:$(this).trigger("click")}})},d=function(e){c.find(".search__found li").removeClass("active"),t.parents().hasClass("site__footer")?(38==e&&n<o?n++:40==e&&n>0&&n--,n>0?(c.find(".search__found li").eq(-1-(n-1)).addClass("active"),i.val(c.find(".search__found li").eq(-1-(n-1)).find("a").text())):i.val(r)):(40==e&&n<o?n++:38==e&&n>0&&n--,n>0?(c.find(".search__found li").eq(n-1).addClass("active"),i.val(c.find(".search__found li").eq(n-1).find("a").text())):i.val(r))},f=function(e){var e=e,t=e.categories,i=0!=t.length,a=e.products,s=0!=a.length,n=[],r=[],l=!0;if(s){var d='<div class="top-products__wrap">';$.each(a,function(){var e=this;d+='<div>                                                <div class="top-products__item">                                                    <div class="top-products__pic" style="background-image: url('+e.src+')">                                                    </div>                                                    <span class="top-products__price"><del>'+e.oldPrice+"</del> "+e.price+'</span>                                                    <h3 class="top-products__item-title">'+e.name+'</h3>                                                    <a href="'+e.href+'" class="top-products__btn">view</a>                                                </div>                                            </div>',i||n.push([e.categories.mainCategory,e.categories.urlMainCategory,e.categories.subcategories,e.categories.urlSubcategories])}),d+="</div>",c.find("div").eq(1).find(".top-products").html('<h2 class="top-products__title">Top Products</h2>'+d);var f='<ul class="search__found">';if(i)$.each(t,function(){var e=this.subcategories,t=this.urlSubcategories,i="";if(void 0!=e){for(var a=0;a<=e.length-1;a++)i+='<li class="search__found-sub"><a href="'+t[a]+'">'+e[a]+"</a></li>";i+=""}f+='<li><a href="'+this.urlCategory+'">'+this.name+"</a></li>"+i});else{for(var u=0;u<=n.length-1;u++)if(l&&(r.push(n[u]),l=!1),r[r.length-1][0]!=n[u][0])r.push(n[u]);else for(var h=0;h<=n[u].length-1;h++)for(var v=0;v<=n[u][2].length-1;v++)r[r.length-1][2].indexOf(n[u][2][v])==-1&&r[r.length-1][2].push(n[u][2][v]);for(var _=0,u=0;u<=r.length-1;u++){for(var h=0;h<=r[u].length-1;h++){for(var p="",v=0;v<=r[u][2].length-1;v++)p+='<li class="search__found-sub"><a href="'+r[u][3][v]+'">'+r[u][2][v]+"</a></li>",_++;p+=""}f+='<li><a href="'+r[u][1]+'">'+r[u][0]+"</a></li>"+p}}f+="</ul>",c.find("div:first").html(f),c.find(".search__found").find("li:not(:lt(11))").remove(),o=c.find(".search__found").find("li").length,c.addClass("visible")}else c.removeClass("visible")},u=function(e,t){return a.abort(),a=$.ajax({url:s,data:{value:e.val(),action:"main_search"},dataType:"json",type:"get",success:function(e){0!=Object.keys(e).length&&f(e)},error:function(e){"abort"!=e.statusText&&console.log("Error")}}),!1},h=function(){l()};h()}}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS5wb3B1cC5qcyIsImpxdWVyeS53ZWJzdGVycy1zZWxlY3QuanMiLCJqcXVlcnkuc2VhcmNoLmpzIl0sIm5hbWVzIjpbIiQiLCJlYWNoIiwiUG9wdXAiLCJ0aGlzIiwib2JqIiwiX3NlbGYiLCJfcG9wdXBQYWRkaW5nIiwiX2J0blNob3ciLCJfb2JqIiwiX2J0bkNsb3NlIiwiZmluZCIsIl93cmFwIiwiX2NvbnRlbnRzIiwiX3Njcm9sbENvbnRlaW5lciIsIl93aW5kb3ciLCJ3aW5kb3ciLCJfdGltZXIiLCJzZXRUaW1lb3V0IiwiX2NlbnRlcldyYXAiLCJoZWlnaHQiLCJjc3MiLCJ0b3AiLCJfZ2V0U2Nyb2xsV2lkdGgiLCJzY3JvbGxCYXJXaWR0aCIsInNjcm9sbERpdiIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsImJvZHkiLCJhcHBlbmRDaGlsZCIsIm9mZnNldFdpZHRoIiwiY2xpZW50V2lkdGgiLCJyZW1vdmVDaGlsZCIsIl9oaWRlIiwib3ZlcmZsb3dZIiwicGFkZGluZ1JpZ2h0IiwicmVtb3ZlQ2xhc3MiLCJhZGRDbGFzcyIsIl9pbml0IiwiX29uRXZlbnRzIiwib24iLCJyZXNpemUiLCJjbGljayIsIl9zaG93IiwiYXR0ciIsImUiLCJzdG9wUHJvcGFnYXRpb24iLCJfc2V0UG9wdXBDb250ZW50IiwiY3VyQ29udGVudCIsImZpbHRlciIsImRpc3BsYXkiLCJXZWJzdGVyc1NlbGVjdCIsIm9wdGlvblR5cGUiLCJzaG93VHlwZSIsInBhcmFtcyIsIl9wb3B1cCIsIl9zY3JvbGwiLCJfb3B0aW9uVHlwZSIsIl9zaG93VHlwZSIsIl92aXNpYmxlIiwidmlzaWJsZSIsIl9kZXZpY2UiLCJ0ZXN0IiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwiX3RleHQiLCJfYm9keSIsIl9vcGVuZWQiLCJfYWRkV3JhcCIsImN1clRleHQiLCJvcGFjaXR5Iiwid3JhcCIsInBhcmVudCIsImFwcGVuZCIsImJlZm9yZSIsImN1ckl0ZW0iLCJ0ZXh0IiwiZXEiLCJfaGlkZVBvcHVwIiwic3RvcCIsInNsaWRlVXAiLCJyZW1vdmUiLCJmYWRlT3V0IiwiX2NvbnN0cnVjdG9yIiwiX3NlbGVjdFZpZXdUeXBlIiwicHJldiIsIl9zaG93UG9wdXAiLCJzY3JvbGwiLCJfc2V0TW9iaWxlVmlldyIsIl9zZXRDdXN0b20xIiwic2VsZWN0cyIsImxpc3QiLCJvZmZzZXQiLCJzY3JvbGxUb3AiLCJtYXhIZWlnaHQiLCJjdXJJbmRleCIsImluZGV4IiwiaWQiLCJNYXRoIiwicm91bmQiLCJyYW5kb20iLCJjaGVja09wZW5lZCIsImNsb3NlIiwiaSIsIndpZHRoIiwib3V0ZXJXaWR0aCIsImxlZnQiLCJvdXRlckhlaWdodCIsInBlcmZlY3RTY3JvbGxiYXIiLCJzbGlkZURvd24iLCJhbmltYXRlIiwidmFsIiwidHJpZ2dlciIsIlNlYXJjaCIsIl9pbnB1dCIsIl9yZXF1ZXN0IiwiWE1MSHR0cFJlcXVlc3QiLCJfcGF0aCIsImRhdGEiLCJzdWdnZXN0U2VsZWN0ZWQiLCJjb3VudEl0ZW1zIiwidmFsdWVJbnB1dCIsIl9yZXN1bHQiLCJfYWRkRXZlbnRzIiwia2V5dXAiLCJJIiwia2V5Q29kZSIsImxlbmd0aCIsInN1Ym1pdCIsIl9hamF4UmVxdWVzdCIsImtleWRvd24iLCJodG1sIiwibG9jYXRpb24iLCJocmVmIiwicHJldmVudERlZmF1bHQiLCJfa2V5QWN0aXZhdGUiLCJldmVudCIsImNhbmNlbEJ1YmJsZSIsIm4iLCJwYXJlbnRzIiwiaGFzQ2xhc3MiLCJfYWRkRGF0YSIsImNhdGVnb3JpZXMiLCJjYXRlZ29yaWVzQXZhaWxhYmlsaXR5IiwicHJvZHVjdHMiLCJwcm9kdWN0c0F2YWlsYWJpbGl0eSIsImFsbFByb2R1Y3RzQ2F0ZWdvcmllc0FyciIsInByb2R1Y3RzQ2F0ZWdvcmllc0FyciIsImZsYWciLCJwcm9kdWN0c1dyYXAiLCJwcm9kdWN0Iiwic3JjIiwib2xkUHJpY2UiLCJwcmljZSIsIm5hbWUiLCJwdXNoIiwibWFpbkNhdGVnb3J5IiwidXJsTWFpbkNhdGVnb3J5Iiwic3ViY2F0ZWdvcmllcyIsInVybFN1YmNhdGVnb3JpZXMiLCJyZXN1bHRTdHIiLCJzdWJjYXRlZ29yaWVzV3JhcCIsInVuZGVmaW5lZCIsInVybENhdGVnb3J5IiwiaiIsInoiLCJpbmRleE9mIiwiY291bnQiLCJpbnB1dCIsImFib3J0IiwiYWpheCIsInVybCIsInZhbHVlIiwiYWN0aW9uIiwiZGF0YVR5cGUiLCJ0eXBlIiwic3VjY2VzcyIsIm1zZyIsIk9iamVjdCIsImtleXMiLCJlcnJvciIsInN0YXR1c1RleHQiLCJjb25zb2xlIiwibG9nIl0sIm1hcHBpbmdzIjoiQ0FBQSxXQUVJQSxFQUFHLFdBRUNBLEVBQUcsVUFBV0MsS0FBSyxXQUVmLEdBQUlDLEdBQU1GLEVBQUVHLFVBTXBCLElBQUlELEdBQVEsU0FBVUUsR0FHbEIsR0FBSUMsR0FBUUYsS0FDUkcsRUFBZ0IsR0FDaEJDLEVBQVlQLEVBQUcsZ0JBQ2ZRLEVBQU9KLEVBQ1BLLEVBQVlELEVBQUtFLEtBQU0saUNBQ3ZCQyxFQUFRSCxFQUFLRSxLQUFNLGdCQUNuQkUsRUFBWUosRUFBS0UsS0FBTSxtQkFDdkJHLEVBQW1CYixFQUFHLFFBQ3RCYyxFQUFVZCxFQUFHZSxRQUNiQyxFQUFTQyxXQUFZLGFBQWMsR0FHbkNDLEVBQWMsV0FDTEosRUFBUUssU0FBNkIsRUFBaEJiLEVBQXNCSyxFQUFNUSxTQUFXLEVBQzdEUixFQUFNUyxLQUFPQyxLQUFTUCxFQUFRSyxTQUE2QixFQUFoQmIsRUFBd0JLLEVBQU1RLFVBQWEsSUFFdEZSLEVBQU1TLEtBQU9DLElBQUssS0FHMUJDLEVBQWtCLFdBQ2QsR0FDSUMsR0FEQUMsRUFBWUMsU0FBU0MsY0FBZSxNQVd4QyxPQVJBRixHQUFVRyxVQUFZLDJCQUV0QkYsU0FBU0csS0FBS0MsWUFBYUwsR0FFM0JELEVBQWlCQyxFQUFVTSxZQUFjTixFQUFVTyxZQUVuRE4sU0FBU0csS0FBS0ksWUFBWVIsR0FFbkJELEdBRVhVLEVBQVEsV0FDSnpCLEVBQUtZLEtBQ0RjLFVBQVcsV0FF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TUFDYjhELE9BQU8sZUFFWEMsU0FBVSxPQUNWQyxLQUFNLE1BQ05DLFFBQVMsU0FBV0MsR0FFZSxHQUEzQkMsT0FBT0MsS0FBS0YsR0FBS2xELFFBQ2pCYyxFQUFVb0MsSUFJbEJHLE1BQU8sU0FBVWhFLEdBQ29CLFNBQTdCQSxFQUFlaUUsWUFDZkMsUUFBUUMsSUFBSSxhQUtqQixHQUVYakosRUFBUSxXQUNKcUYsSUFPUnJGIiwiZmlsZSI6InVpLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiggZnVuY3Rpb24oKXtcblxuICAgICQoIGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgJCggJy5wb3B1cCcgKS5lYWNoKGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgIG5ldyBQb3B1cCgkKHRoaXMpKTtcblxuICAgICAgICB9KTtcblxuICAgIH0pO1xuXG4gICAgdmFyIFBvcHVwID0gZnVuY3Rpb24oIG9iaiApe1xuXG4gICAgICAgIC8vcHJpdmF0ZSBwcm9wZXJ0aWVzXG4gICAgICAgIHZhciBfc2VsZiA9IHRoaXMsXG4gICAgICAgICAgICBfcG9wdXBQYWRkaW5nID0gNDAsXG4gICAgICAgICAgICBfYnRuU2hvdyA9ICAkKCAnLnBvcHVwX19vcGVuJyApLFxuICAgICAgICAgICAgX29iaiA9IG9iaixcbiAgICAgICAgICAgIF9idG5DbG9zZSA9IF9vYmouZmluZCggJy5wb3B1cF9fY2xvc2UsIC5wb3B1cF9fY2FuY2VsJyApLFxuICAgICAgICAgICAgX3dyYXAgPSBfb2JqLmZpbmQoICcucG9wdXBfX3dyYXAnICksXG4gICAgICAgICAgICBfY29udGVudHMgPSBfb2JqLmZpbmQoICcucG9wdXBfX2NvbnRlbnQnICksXG4gICAgICAgICAgICBfc2Nyb2xsQ29udGVpbmVyID0gJCggJ2h0bWwnICksXG4gICAgICAgICAgICBfd2luZG93ID0gJCggd2luZG93ICksXG4gICAgICAgICAgICBfdGltZXIgPSBzZXRUaW1lb3V0KCBmdW5jdGlvbigpe30sIDEgKTtcblxuICAgICAgICAvL3ByaXZhdGUgbWV0aG9kc1xuICAgICAgICB2YXIgX2NlbnRlcldyYXAgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIGlmICggX3dpbmRvdy5oZWlnaHQoKSAtICggX3BvcHVwUGFkZGluZyAqIDIgKSAtIF93cmFwLmhlaWdodCgpID4gMCApIHtcbiAgICAgICAgICAgICAgICAgICAgX3dyYXAuY3NzKCB7IHRvcDogKCAoIF93aW5kb3cuaGVpZ2h0KCkgLSAoIF9wb3B1cFBhZGRpbmcgKiAyICkgKSAtIF93cmFwLmhlaWdodCgpICkgLyAyIH0gKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBfd3JhcC5jc3MoIHsgdG9wOiAwIH0gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2dldFNjcm9sbFdpZHRoID0gZnVuY3Rpb24gKCl7XG4gICAgICAgICAgICAgICAgdmFyIHNjcm9sbERpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdkaXYnKSxcbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsQmFyV2lkdGg7XG5cbiAgICAgICAgICAgICAgICBzY3JvbGxEaXYuY2xhc3NOYW1lID0gJ3BvcHVwX19zY3JvbGxiYXItbWVhc3VyZSc7XG5cbiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKCBzY3JvbGxEaXYgKTtcblxuICAgICAgICAgICAgICAgIHNjcm9sbEJhcldpZHRoID0gc2Nyb2xsRGl2Lm9mZnNldFdpZHRoIC0gc2Nyb2xsRGl2LmNsaWVudFdpZHRoO1xuXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChzY3JvbGxEaXYpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNjcm9sbEJhcldpZHRoO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9oaWRlID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBfb2JqLmNzcygge1xuICAgICAgICAgICAgICAgICAgICBvdmVyZmxvd1k6ICdoaWRkZW4nXG4gICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgIF9zY3JvbGxDb250ZWluZXIuY3NzKCB7XG4gICAgICAgICAgICAgICAgICAgIG92ZXJmbG93WTogJ2F1dG8nLFxuICAgICAgICAgICAgICAgICAgICBwYWRkaW5nUmlnaHQ6IDBcbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICBfb2JqLnJlbW92ZUNsYXNzKCAncG9wdXBfb3BlbmVkJyApO1xuICAgICAgICAgICAgICAgIF9vYmouYWRkQ2xhc3MoICdwb3B1cF9oaWRlJyApO1xuXG4gICAgICAgICAgICAgICAgX3RpbWVyID0gc2V0VGltZW91dCggZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgICAgICAgICBfb2JqLmNzcyAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgb3ZlcmZsb3dZOiAnYXV0bydcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgX29iai5yZW1vdmVDbGFzcyggJ3BvcHVwX2hpZGUnICk7XG4gICAgICAgICAgICAgICAgfSwgMzAwICk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaW5pdCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgX29ialsgMCBdLm9iaiA9IF9zZWxmO1xuICAgICAgICAgICAgICAgIF9vbkV2ZW50cygpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9vbkV2ZW50cyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgX3dpbmRvdy5vbigge1xuICAgICAgICAgICAgICAgICAgICByZXNpemU6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBfY2VudGVyV3JhcCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgIF9idG5TaG93Lm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgX3Nob3coICQoIHRoaXMgKS5hdHRyKCAnZGF0YS1wb3B1cCcgKSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgIF9jb250ZW50cy5maW5kKCc+ZGl2Jykub24oIHtcbiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKCBlICl7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgIF9vYmoub24oIHtcbiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBfaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgIF9idG5DbG9zZS5vbigge1xuICAgICAgICAgICAgICAgICAgICBjbGljazogZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX3Nob3cgPSBmdW5jdGlvbiggY2xhc3NOYW1lICl7XG4gICAgICAgICAgICAgICAgX3NldFBvcHVwQ29udGVudCggY2xhc3NOYW1lICk7XG5cbiAgICAgICAgICAgICAgICBfc2Nyb2xsQ29udGVpbmVyLmNzcygge1xuICAgICAgICAgICAgICAgICAgICBvdmVyZmxvd1k6ICdoaWRkZW4nLFxuICAgICAgICAgICAgICAgICAgICBwYWRkaW5nUmlnaHQ6IF9nZXRTY3JvbGxXaWR0aCgpXG4gICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgIF9vYmouYWRkQ2xhc3MoICdwb3B1cF9vcGVuZWQnICk7XG4gICAgICAgICAgICAgICAgX2NlbnRlcldyYXAoKTtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9zZXRQb3B1cENvbnRlbnQgPSBmdW5jdGlvbiggY2xhc3NOYW1lICl7XG4gICAgICAgICAgICAgICAgdmFyIGN1ckNvbnRlbnQgPSBfY29udGVudHMuZmlsdGVyKCAnLnBvcHVwX18nICsgY2xhc3NOYW1lICk7XG5cbiAgICAgICAgICAgICAgICBfY29udGVudHMuY3NzKCB7IGRpc3BsYXk6ICdub25lJyB9ICk7XG4gICAgICAgICAgICAgICAgY3VyQ29udGVudC5jc3MoIHsgZGlzcGxheTogJ2Jsb2NrJyB9ICk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIC8vcHVibGljIHByb3BlcnRpZXNcblxuICAgICAgICAvL3B1YmxpYyBtZXRob2RzXG5cblxuICAgICAgICBfaW5pdCgpO1xuICAgIH07XG59ICkoKTtcblxuIiwiKCBmdW5jdGlvbigpe1xuXG4gICAgJCggZnVuY3Rpb24oKXtcbiAgICAgICAgJCggJ3NlbGVjdCcgKS5lYWNoKCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgbmV3IFdlYnN0ZXJzU2VsZWN0KCB7XG4gICAgICAgICAgICAgICAgb2JqOiAkKCB0aGlzICksXG4gICAgICAgICAgICAgICAgb3B0aW9uVHlwZTogMSxcbiAgICAgICAgICAgICAgICBzaG93VHlwZTogMlxuICAgICAgICAgICAgfSApO1xuXG4gICAgICAgIH0gKTtcbiAgICB9ICk7XG5cbiAgICB2YXIgV2Vic3RlcnNTZWxlY3QgPSBmdW5jdGlvbiggcGFyYW1zICl7XG5cbiAgICAgICAgLy9wcml2YXRlIHByb3BlcnRpZXNcbiAgICAgICAgdmFyIF9zZWxmID0gdGhpcyxcbiAgICAgICAgICAgIF9vYmogPSBwYXJhbXMub2JqLFxuICAgICAgICAgICAgX29wdGlvblR5cGUgPSBwYXJhbXMub3B0aW9uVHlwZSB8fCAwLFxuICAgICAgICAgICAgX3Nob3dUeXBlID0gcGFyYW1zLnNob3dUeXBlIHx8IDAsXG4gICAgICAgICAgICBfdmlzaWJsZSA9IHBhcmFtcy52aXNpYmxlIHx8IDUsXG4gICAgICAgICAgICBfZGV2aWNlID0gL0FuZHJvaWR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxCbGFja0JlcnJ5fElFTW9iaWxlfE9wZXJhIE1pbmkvaS50ZXN0KCBuYXZpZ2F0b3IudXNlckFnZW50ICksXG4gICAgICAgICAgICBfdGV4dCA9ICQoICc8c3BhbiBjbGFzcz1cIndlYnN0ZXJzLXNlbGVjdF9faXRlbVwiPjwvc3Bhbj4nICksXG4gICAgICAgICAgICBfd3JhcCA9ICQoICc8ZGl2IGNsYXNzPVwid2Vic3RlcnMtc2VsZWN0XCI+PC9kaXY+JyApLFxuICAgICAgICAgICAgX3dpbmRvdyA9ICQoIHdpbmRvdyApLFxuICAgICAgICAgICAgX2JvZHkgPSAkKCAnYm9keScgKSxcbiAgICAgICAgICAgIF9vcGVuZWQgPSBmYWxzZSxcbiAgICAgICAgICAgIF9wb3B1cCwgX3Njcm9sbDtcblxuICAgICAgICAvL3ByaXZhdGUgbWV0aG9kc1xuICAgICAgICB2YXIgX2FkZFdyYXAgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIHZhciBjdXJUZXh0ID0gJyc7XG5cbiAgICAgICAgICAgICAgICBfb2JqLmNzcygge1xuICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiAwXG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgX29iai53cmFwKCBfd3JhcCApO1xuICAgICAgICAgICAgICAgIF93cmFwID0gX29iai5wYXJlbnQoKTtcbiAgICAgICAgICAgICAgICBfd3JhcC5hcHBlbmQoICc8ZGl2IGNsYXNzPVwid2Vic3RlcnMtc2VsZWN0X19hcnJvd1wiPjwvZGl2PicgKTtcbiAgICAgICAgICAgICAgICBfb2JqLmJlZm9yZSggX3RleHQgKTtcbiAgICAgICAgICAgICAgICBfb2JqLmZpbmQoICdvcHRpb24nICkuZWFjaCggZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1ckl0ZW0gPSAkKCB0aGlzICk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYoIGN1ckl0ZW0uYXR0ciggJ3NlbGVjdGVkJyApID09ICdzZWxlY3RlZCcgKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1clRleHQgPSBjdXJJdGVtLnRleHQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgIGlmKCBjdXJUZXh0ID09ICcnICl7XG4gICAgICAgICAgICAgICAgICAgIGN1clRleHQgPSAgX29iai5maW5kKCAnb3B0aW9uJykuZXEoIDAgKS50ZXh0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF90ZXh0LnRleHQoIGN1clRleHQgKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaGlkZVBvcHVwID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBfb3BlbmVkID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICBpZiggIV9zaG93VHlwZSApe1xuICAgICAgICAgICAgICAgICAgICBfcG9wdXAuY3NzKCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiAnbm9uZSdcbiAgICAgICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiggX3Nob3dUeXBlID09IDEgKXtcbiAgICAgICAgICAgICAgICAgICAgX3BvcHVwLnN0b3AoIHRydWUsIGZhbHNlICkuc2xpZGVVcCggMzAwLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgX3BvcHVwLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmKCBfc2hvd1R5cGUgPT0gMiApIHtcbiAgICAgICAgICAgICAgICAgICAgX3BvcHVwLnN0b3AoIHRydWUsIGZhbHNlICkuZmFkZU91dCggMzAwLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgX3BvcHVwLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgX3dyYXAucmVtb3ZlQ2xhc3MoICd3ZWJzdGVycy1zZWxlY3Rfb3BlbmVkJyApO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2NvbnN0cnVjdG9yID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBfb2JqWyAwIF0ub2JqID0gX3NlbGY7XG5cbiAgICAgICAgICAgICAgICBfYWRkV3JhcCgpO1xuICAgICAgICAgICAgICAgIF9zZWxlY3RWaWV3VHlwZSgpO1xuICAgICAgICAgICAgICAgIF9vbkV2ZW50cygpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9vbkV2ZW50cyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgX29iai5vbiggJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBfdGV4dC50ZXh0KCAkKCB0aGlzICkuZmluZCggJ29wdGlvbjpzZWxlY3RlZCcgKS50ZXh0KCkgKTtcblxuICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgICAgICAkKGRvY3VtZW50KS5vbihcbiAgICAgICAgICAgICAgICAgICAgXCJjaGFuZ2VcIixcbiAgICAgICAgICAgICAgICAgICAgXCJzZWxlY3RcIixcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKCB0aGlzKS5wcmV2KCkudGV4dCggJCggdGhpcyApLmZpbmQoICdvcHRpb246c2VsZWN0ZWQnICkudGV4dCgpICk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgaWYoIF9vcHRpb25UeXBlID09IDEgJiYgIV9kZXZpY2UgKXtcbiAgICAgICAgICAgICAgICAgICAgX3dyYXAub24oIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdjbGljayc6IGZ1bmN0aW9uKCBlICl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBfb3BlbmVkICl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9oaWRlUG9wdXAoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfc2hvd1BvcHVwKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgX2JvZHkub24oIHtcbiAgICAgICAgICAgICAgICAgICAgJ2NsaWNrJzogZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBfb3BlbmVkICl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2hpZGVQb3B1cCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgX3dpbmRvdy5vbigge1xuICAgICAgICAgICAgICAgICAgICAnc2Nyb2xsJzogZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBfb3BlbmVkICl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2hpZGVQb3B1cCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX3NlbGVjdFZpZXdUeXBlID0gZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgICAgIGlmKCAhX29wdGlvblR5cGUgfHwgX2RldmljZSApe1xuICAgICAgICAgICAgICAgICAgICBfc2V0TW9iaWxlVmlldygpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiggX29wdGlvblR5cGUgPT0gMSApe1xuICAgICAgICAgICAgICAgICAgICBfc2V0Q3VzdG9tMSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfc2V0Q3VzdG9tMSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgX3dyYXAuYWRkQ2xhc3MoICd3ZWJzdGVycy1zZWxlY3RfY3VzdG9tJyApO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9zZXRNb2JpbGVWaWV3ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBfd3JhcC5hZGRDbGFzcyggJ3dlYnN0ZXJzLXNlbGVjdF9tb2JpbGUnICk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX3Nob3dQb3B1cCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgdmFyIHNlbGVjdHMgPSAkKCAnc2VsZWN0JyApLFxuICAgICAgICAgICAgICAgICAgICBsaXN0ID0gJCggJzx1bD48L3VsPicpLFxuICAgICAgICAgICAgICAgICAgICBjdXJTY3JvbGwgPSBfd2luZG93LnNjcm9sbFRvcCgpLFxuICAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSBfd3JhcC5vZmZzZXQoKSxcbiAgICAgICAgICAgICAgICAgICAgbWF4SGVpZ2h0ID0gMCxcbiAgICAgICAgICAgICAgICAgICAgY3VySW5kZXggPSBfb2JqLmZpbmQoICdvcHRpb246c2VsZWN0ZWQnICkuaW5kZXgoKSxcbiAgICAgICAgICAgICAgICAgICAgaWQgPSBNYXRoLnJvdW5kKCBNYXRoLnJhbmRvbSgpICogMTAwMCApO1xuXG4gICAgICAgICAgICAgICAgc2VsZWN0cy5lYWNoKCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICBpZiggdGhpcyAhPT0gX29ialsgMCBdICYmIHRoaXMub2JqLmNoZWNrT3BlbmVkKCkgKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2JqLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICBpZiggX29wZW5lZCApe1xuICAgICAgICAgICAgICAgICAgICBfcG9wdXAucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF9vcGVuZWQgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgX3BvcHVwID0gJCggJzxkaXYgY2xhc3M9XCJ3ZWJzdGVycy1zZWxlY3RfX3BvcHVwXCIgaWQ9XCJ3ZWJzdGVycy1zZWxlY3RfX3BvcHVwJyArIGlkICsgJ1wiPjwvZGl2PicgKTtcblxuICAgICAgICAgICAgICAgIF9vYmouZmluZCggJ29wdGlvbicgKS5lYWNoKCBmdW5jdGlvbiggaSApe1xuICAgICAgICAgICAgICAgICAgICB2YXIgY3VySXRlbSA9ICQoIHRoaXMgKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiggaSA9PSBjdXJJbmRleCApe1xuICAgICAgICAgICAgICAgICAgICAgICAgbGlzdC5hcHBlbmQoICc8bGkgY2xhc3M9XCJhY3RpdmVcIj4nICsgY3VySXRlbS50ZXh0KCkgKyAnPC9saT4nICk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaXN0LmFwcGVuZCggJzxsaT4nICsgY3VySXRlbS50ZXh0KCkgKyAnPC9saT4nICk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgIF9wb3B1cC5hcHBlbmQoIGxpc3QgKTtcbiAgICAgICAgICAgICAgICBfYm9keS5hcHBlbmQoIF9wb3B1cCApO1xuICAgICAgICAgICAgICAgIF93cmFwLmFkZENsYXNzKCAnd2Vic3RlcnMtc2VsZWN0X29wZW5lZCcgKTtcblxuICAgICAgICAgICAgICAgIF9wb3B1cC5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IF93cmFwLm91dGVyV2lkdGgoKSxcbiAgICAgICAgICAgICAgICAgICAgbGVmdDogb2Zmc2V0LmxlZnQsXG4gICAgICAgICAgICAgICAgICAgIHRvcDogb2Zmc2V0LnRvcCArIF93cmFwLm91dGVySGVpZ2h0KClcbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICBtYXhIZWlnaHQgPSBfcG9wdXAub3V0ZXJIZWlnaHQoKTtcbiAgICAgICAgICAgICAgICBpZiggbWF4SGVpZ2h0ID4gX3BvcHVwLmZpbmQoICdsaScgKS5lcSggMCApLm91dGVySGVpZ2h0KCkgKiBfdmlzaWJsZSApe1xuICAgICAgICAgICAgICAgICAgICBfcG9wdXAuaGVpZ2h0KCBfcG9wdXAuZmluZCggJ2xpJyApLmVxKCAwICkub3V0ZXJIZWlnaHQoKSAqIF92aXNpYmxlICk7XG4gICAgICAgICAgICAgICAgICAgIF9zY3JvbGwgPSBfcG9wdXAucGVyZmVjdFNjcm9sbGJhcigpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmKCBfc2hvd1R5cGUgPT0gMSApe1xuICAgICAgICAgICAgICAgICAgICBfcG9wdXAuY3NzKCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiAnbm9uZSdcbiAgICAgICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgICAgICBfcG9wdXAuc2xpZGVEb3duKCAzMDAgKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYoIF9zaG93VHlwZSA9PSAyICkge1xuICAgICAgICAgICAgICAgICAgICBfcG9wdXAuY3NzKCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiAwLjFcbiAgICAgICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgICAgICBfcG9wdXAuYW5pbWF0ZSggeyBvcGFjaXR5OiAxIH0sIDMwMCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgX3BvcHVwLmZpbmQoICdsaScgKS5vbigge1xuICAgICAgICAgICAgICAgICAgICAnY2xpY2snOiBmdW5jdGlvbiggZSApe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gJCggdGhpcyApLmluZGV4KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9vYmoudmFsKCBfb2JqLmZpbmQoICdvcHRpb24nICkuZXEoIGluZGV4ICkuYXR0ciggJ3ZhbHVlJyApICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfb2JqLnRyaWdnZXIoICdjaGFuZ2UnICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfaGlkZVBvcHVwKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgLy9wdWJsaWMgcHJvcGVydGllc1xuXG4gICAgICAgIC8vcHVibGljIG1ldGhvZHNcbiAgICAgICAgX3NlbGYuY2hlY2tPcGVuZWQgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgcmV0dXJuIF9vcGVuZWQ7XG4gICAgICAgIH07XG4gICAgICAgIF9zZWxmLmNsb3NlID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIF9oaWRlUG9wdXAoKTtcbiAgICAgICAgfTtcblxuXG4gICAgICAgIF9jb25zdHJ1Y3RvcigpO1xuXG4gICAgfTtcblxufSApKCk7IiwiKCBmdW5jdGlvbigpe1xuXG4gICAgJChmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgJCgnLnNlYXJjaCcpLmVhY2goZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICBuZXcgU2VhcmNoKCAkKHRoaXMpICk7XG5cbiAgICAgICAgfSApO1xuXG4gICAgfSApO1xuXG4gICAgdmFyIFNlYXJjaCA9IGZ1bmN0aW9uIChvYmopIHtcblxuICAgICAgICAvL3ByaXZhdGUgcHJvcGVydGllc1xuICAgICAgICB2YXIgX29iaiA9IG9iaixcbiAgICAgICAgICAgIF9pbnB1dCA9IF9vYmouZmluZCgnaW5wdXRbdHlwZT1zZWFyY2hdJyksXG4gICAgICAgICAgICBfcmVxdWVzdCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpLFxuICAgICAgICAgICAgX3BhdGggPSBfb2JqLmRhdGEoJ3BhdGgnKSxcbiAgICAgICAgICAgIHN1Z2dlc3RTZWxlY3RlZCA9IDAsXG4gICAgICAgICAgICBjb3VudEl0ZW1zID0gMCxcbiAgICAgICAgICAgIHZhbHVlSW5wdXQgPSBfaW5wdXQudmFsKCksXG4gICAgICAgICAgICBfcmVzdWx0ID0gX29iai5maW5kKCcuc2VhcmNoX19yZXN1bHQnKTtcblxuICAgICAgICAvL3ByaXZhdGUgbWV0aG9kc1xuXG4gICAgICAgIHZhciBfYWRkRXZlbnRzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgX2lucHV0Lm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIGtleXVwOiBmdW5jdGlvbihJKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCAkKHdpbmRvdykud2lkdGgoKSA+PSAxMDI0ICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoKEkua2V5Q29kZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEzOlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiggX3Jlc3VsdC5maW5kKCcuc2VhcmNoX19mb3VuZCBsaScpLmZpbHRlcignLmFjdGl2ZScpLmxlbmd0aCA9PSAwICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9vYmouZmluZCgnZm9ybScpLnN1Ym1pdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzMjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyNzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzNzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzODpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0MDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWVJbnB1dCA9ICQodGhpcykudmFsKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY291bnQgPSAwO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiggdmFsdWVJbnB1dC5sZW5ndGggPj0gX29iai5kYXRhKCdzeW1ib2xzJykgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYWpheFJlcXVlc3QoICQodGhpcyksIHZhbHVlSW5wdXQubGVuZ3RoKTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoICQodGhpcykudmFsKCkgPT0gJycgKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3Jlc3VsdC5yZW1vdmVDbGFzcygndmlzaWJsZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWdnZXN0U2VsZWN0ZWQgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGtleWRvd246IGZ1bmN0aW9uKEkpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX3Jlc3VsdC5maW5kKCcuc2VhcmNoX19mb3VuZCcpLmh0bWwoJycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX3Jlc3VsdC5maW5kKCcudG9wLXByb2R1Y3RzJykuaHRtbCgnJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Z2dlc3RTZWxlY3RlZCA9IDA7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCAkKHdpbmRvdykud2lkdGgoKSA+PSAxMDI0ICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoKCBJLmtleUNvZGUgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTM6XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBfcmVzdWx0LmZpbmQoJy5zZWFyY2hfX2ZvdW5kIGxpJykuZmlsdGVyKCcuYWN0aXZlJykubGVuZ3RoID09IDAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBfb2JqLmRhdGEoJ2FjdGlvbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IF9yZXN1bHQuZmluZCgnLnNlYXJjaF9fZm91bmQgbGknKS5maWx0ZXIoJy5hY3RpdmUnKS5maW5kKCdhJykuYXR0cignaHJlZicpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI3OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3Jlc3VsdC5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Z2dlc3RTZWxlY3RlZCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM4OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiggY291bnRJdGVtcyA+IDAgKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfa2V5QWN0aXZhdGUoIEkua2V5Q29kZSApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIHN1Z2dlc3RTZWxlY3RlZCA9PSBjb3VudEl0ZW1zKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VnZ2VzdFNlbGVjdGVkID0gMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgJCgnaHRtbCcpLmNsaWNrKCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICBfcmVzdWx0LnJlbW92ZUNsYXNzKCd2aXNpYmxlJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgc3VnZ2VzdFNlbGVjdGVkID0gMDtcblxuICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgICAgICAkKGRvY3VtZW50KS5vbihcbiAgICAgICAgICAgICAgICAgICAgXCJjbGlja1wiLFxuICAgICAgICAgICAgICAgICAgICBcImJvZHlcIixcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oIGV2ZW50ICl7XG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudCA9IGV2ZW50IHx8IHdpbmRvdy5ldmVudDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LnN0b3BQcm9wYWdhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudC5jYW5jZWxCdWJibGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAkKGRvY3VtZW50KS5vbihcbiAgICAgICAgICAgICAgICAgICAgXCJjbGlja1wiLFxuICAgICAgICAgICAgICAgICAgICBcIi5zZWFyY2hfX2ZvdW5kIGxpXCIsXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1ckl0ZW0gPSAkKHRoaXMpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1clRleHQgPSBjdXJJdGVtLmZpbmQoJ2EnKS50ZXh0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9pbnB1dC52YWwoY3VyVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfcmVzdWx0LnJlbW92ZUNsYXNzKCd2aXNpYmxlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWdnZXN0U2VsZWN0ZWQgPSAwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAkKGRvY3VtZW50KS5vbihcbiAgICAgICAgICAgICAgICAgICAgXCJrZXlkb3duXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiLnNlYXJjaF9fZm91bmQgbGlcIixcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oSSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goSS5rZXlDb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMzpcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnRyaWdnZXIoJ2NsaWNrJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9rZXlBY3RpdmF0ZSA9IGZ1bmN0aW9uKG4pIHtcblxuICAgICAgICAgICAgICAgIF9yZXN1bHQuZmluZCgnLnNlYXJjaF9fZm91bmQgbGknKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAgICAgICAgICAgICBpZiggX29iai5wYXJlbnRzKCkuaGFzQ2xhc3MoJ3NpdGVfX2Zvb3RlcicpICkge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKCBuID09IDM4ICYmIHN1Z2dlc3RTZWxlY3RlZCA8IGNvdW50SXRlbXMgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Z2dlc3RTZWxlY3RlZCsrO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIG4gPT0gNDAgJiYgc3VnZ2VzdFNlbGVjdGVkID4gMCApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgc3VnZ2VzdFNlbGVjdGVkLS07XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiggc3VnZ2VzdFNlbGVjdGVkID4gMCApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX3Jlc3VsdC5maW5kKCcuc2VhcmNoX19mb3VuZCBsaScpLmVxKCAtMSAtIChzdWdnZXN0U2VsZWN0ZWQgLSAxKSApLmFkZENsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pbnB1dC52YWwoIF9yZXN1bHQuZmluZCgnLnNlYXJjaF9fZm91bmQgbGknKS5lcSggLTEgLSAoc3VnZ2VzdFNlbGVjdGVkIC0gMSkgKS5maW5kKCdhJykudGV4dCgpICk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX2lucHV0LnZhbCggdmFsdWVJbnB1dCApO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYoIG4gPT0gNDAgJiYgc3VnZ2VzdFNlbGVjdGVkIDwgY291bnRJdGVtcyApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgc3VnZ2VzdFNlbGVjdGVkKys7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICggbiA9PSAzOCAmJiBzdWdnZXN0U2VsZWN0ZWQgPiAwICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBzdWdnZXN0U2VsZWN0ZWQtLTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmKCBzdWdnZXN0U2VsZWN0ZWQgPiAwICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfcmVzdWx0LmZpbmQoJy5zZWFyY2hfX2ZvdW5kIGxpJykuZXEoIHN1Z2dlc3RTZWxlY3RlZCAtIDEgKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfaW5wdXQudmFsKCBfcmVzdWx0LmZpbmQoJy5zZWFyY2hfX2ZvdW5kIGxpJykuZXEoIHN1Z2dlc3RTZWxlY3RlZCAtIDEgKS5maW5kKCdhJykudGV4dCgpICk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX2lucHV0LnZhbCggdmFsdWVJbnB1dCApO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2FkZERhdGEgPSBmdW5jdGlvbiggZGF0YSApIHtcblxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gZGF0YSxcbiAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcmllcyA9IGRhdGEuY2F0ZWdvcmllcyxcbiAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcmllc0F2YWlsYWJpbGl0eSA9IGNhdGVnb3JpZXMubGVuZ3RoICE9IDAsXG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RzID0gZGF0YS5wcm9kdWN0cyxcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdHNBdmFpbGFiaWxpdHkgPSBwcm9kdWN0cy5sZW5ndGggIT0gMCxcbiAgICAgICAgICAgICAgICAgICAgYWxsUHJvZHVjdHNDYXRlZ29yaWVzQXJyID0gW10sXG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RzQ2F0ZWdvcmllc0FyciA9IFtdLFxuICAgICAgICAgICAgICAgICAgICB1cmxQcm9kdWN0c0NhdGVnb3JpZXNBcnIgPSBbXSxcbiAgICAgICAgICAgICAgICAgICAgZmxhZyA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICBpZiggcHJvZHVjdHNBdmFpbGFiaWxpdHkgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb2R1Y3RzV3JhcCA9ICc8ZGl2IGNsYXNzPVwidG9wLXByb2R1Y3RzX193cmFwXCI+JztcblxuICAgICAgICAgICAgICAgICAgICAkLmVhY2goIHByb2R1Y3RzLCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByb2R1Y3QgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0c1dyYXAgKz0gJzxkaXY+XFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0b3AtcHJvZHVjdHNfX2l0ZW1cIj5cXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0b3AtcHJvZHVjdHNfX3BpY1wiIHN0eWxlPVwiYmFja2dyb3VuZC1pbWFnZTogdXJsKCcrIHByb2R1Y3Quc3JjICsnKVwiPlxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cInRvcC1wcm9kdWN0c19fcHJpY2VcIj48ZGVsPicrIHByb2R1Y3Qub2xkUHJpY2UgKyc8L2RlbD4gJysgcHJvZHVjdC5wcmljZSArJzwvc3Bhbj5cXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoMyBjbGFzcz1cInRvcC1wcm9kdWN0c19faXRlbS10aXRsZVwiPicrIHByb2R1Y3QubmFtZSArJzwvaDM+XFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPVwiJysgcHJvZHVjdC5ocmVmICsnXCIgY2xhc3M9XCJ0b3AtcHJvZHVjdHNfX2J0blwiPnZpZXc8L2E+XFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pic7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggIWNhdGVnb3JpZXNBdmFpbGFiaWxpdHkgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGxQcm9kdWN0c0NhdGVnb3JpZXNBcnIucHVzaCggW3Byb2R1Y3QuY2F0ZWdvcmllcy5tYWluQ2F0ZWdvcnksIHByb2R1Y3QuY2F0ZWdvcmllcy51cmxNYWluQ2F0ZWdvcnksIHByb2R1Y3QuY2F0ZWdvcmllcy5zdWJjYXRlZ29yaWVzLCBwcm9kdWN0LmNhdGVnb3JpZXMudXJsU3ViY2F0ZWdvcmllc10gKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0c1dyYXAgKz0gJzwvZGl2Pic7XG5cbiAgICAgICAgICAgICAgICAgICAgX3Jlc3VsdC5maW5kKCdkaXYnKS5lcSgxKS5maW5kKCcudG9wLXByb2R1Y3RzJykuaHRtbCgnPGgyIGNsYXNzPVwidG9wLXByb2R1Y3RzX190aXRsZVwiPlRvcCBQcm9kdWN0czwvaDI+JyArIHByb2R1Y3RzV3JhcCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdFN0ciA9ICc8dWwgY2xhc3M9XCJzZWFyY2hfX2ZvdW5kXCI+JztcblxuICAgICAgICAgICAgICAgICAgICBpZiggY2F0ZWdvcmllc0F2YWlsYWJpbGl0eSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgJC5lYWNoKCBjYXRlZ29yaWVzLCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJjYXRlZ29yaWVzID0gdGhpcy5zdWJjYXRlZ29yaWVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmxTdWJjYXRlZ29yaWVzID0gdGhpcy51cmxTdWJjYXRlZ29yaWVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJjYXRlZ29yaWVzV3JhcCA9ICcnO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIHN1YmNhdGVnb3JpZXMgIT0gdW5kZWZpbmVkICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciggdmFyIGkgPSAwOyBpIDw9IHN1YmNhdGVnb3JpZXMubGVuZ3RoLTE7IGkrKyApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViY2F0ZWdvcmllc1dyYXAgKz0gJzxsaSBjbGFzcz1cInNlYXJjaF9fZm91bmQtc3ViXCI+PGEgaHJlZj1cIicrIHVybFN1YmNhdGVnb3JpZXNbaV0gKydcIj4nICsgc3ViY2F0ZWdvcmllc1tpXSArICc8L2E+PC9saT4nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViY2F0ZWdvcmllc1dyYXAgKz0gJyc7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRTdHIgKz0gJzxsaT48YSBocmVmPVwiJysgdGhpcy51cmxDYXRlZ29yeSArJ1wiPicrIHRoaXMubmFtZSArJzwvYT48L2xpPicrIHN1YmNhdGVnb3JpZXNXcmFwICsnJztcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8PSBhbGxQcm9kdWN0c0NhdGVnb3JpZXNBcnIubGVuZ3RoLTE7IGkrKyApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBmbGFnICl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RzQ2F0ZWdvcmllc0Fyci5wdXNoKGFsbFByb2R1Y3RzQ2F0ZWdvcmllc0FycltpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZsYWcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiggcHJvZHVjdHNDYXRlZ29yaWVzQXJyW3Byb2R1Y3RzQ2F0ZWdvcmllc0Fyci5sZW5ndGgtMV1bMF0gIT0gYWxsUHJvZHVjdHNDYXRlZ29yaWVzQXJyW2ldWzBdICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RzQ2F0ZWdvcmllc0Fyci5wdXNoKGFsbFByb2R1Y3RzQ2F0ZWdvcmllc0FycltpXSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoIHZhciBqID0gMDsgaiA8PSBhbGxQcm9kdWN0c0NhdGVnb3JpZXNBcnJbaV0ubGVuZ3RoLTE7IGorKyApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICggdmFyIHogPSAwOyB6IDw9IGFsbFByb2R1Y3RzQ2F0ZWdvcmllc0FycltpXVsyXS5sZW5ndGgtMTsgeisrICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIHByb2R1Y3RzQ2F0ZWdvcmllc0Fycltwcm9kdWN0c0NhdGVnb3JpZXNBcnIubGVuZ3RoLTFdWzJdLmluZGV4T2YoIGFsbFByb2R1Y3RzQ2F0ZWdvcmllc0FycltpXVsyXVt6XSkgPT0gLTEgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdHNDYXRlZ29yaWVzQXJyW3Byb2R1Y3RzQ2F0ZWdvcmllc0Fyci5sZW5ndGgtMV1bMl0ucHVzaCggYWxsUHJvZHVjdHNDYXRlZ29yaWVzQXJyW2ldWzJdW3pdIClcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY291bnQgPSAwO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPD0gcHJvZHVjdHNDYXRlZ29yaWVzQXJyLmxlbmd0aC0xOyBpKysgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKCB2YXIgaiA9IDA7IGogPD0gcHJvZHVjdHNDYXRlZ29yaWVzQXJyW2ldLmxlbmd0aC0xOyBqKysgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YmNhdGVnb3JpZXNXcmFwID0gJyc7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKCB2YXIgeiA9IDA7IHogPD0gcHJvZHVjdHNDYXRlZ29yaWVzQXJyW2ldWzJdLmxlbmd0aC0xOyB6KysgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YmNhdGVnb3JpZXNXcmFwICs9ICc8bGkgY2xhc3M9XCJzZWFyY2hfX2ZvdW5kLXN1YlwiPjxhIGhyZWY9XCInICsgcHJvZHVjdHNDYXRlZ29yaWVzQXJyW2ldWzNdW3pdICsgJ1wiPicgKyBwcm9kdWN0c0NhdGVnb3JpZXNBcnJbaV1bMl1bel0gKyAnPC9hPjwvbGk+JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50ICsrO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJjYXRlZ29yaWVzV3JhcCArPSAnJztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFN0ciArPSAnPGxpPjxhIGhyZWY9XCInICsgcHJvZHVjdHNDYXRlZ29yaWVzQXJyW2ldWzFdICsgJ1wiPicgKyBwcm9kdWN0c0NhdGVnb3JpZXNBcnJbaV1bMF0gKyAnPC9hPjwvbGk+Jysgc3ViY2F0ZWdvcmllc1dyYXAgKycnO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFN0ciArPSAnPC91bD4nO1xuXG4gICAgICAgICAgICAgICAgICAgIF9yZXN1bHQuZmluZCgnZGl2OmZpcnN0JykuaHRtbChyZXN1bHRTdHIpO1xuXG4gICAgICAgICAgICAgICAgICAgIF9yZXN1bHQuZmluZCgnLnNlYXJjaF9fZm91bmQnKS5maW5kKCdsaTpub3QoOmx0KDExKSknKS5yZW1vdmUoKTtcblxuICAgICAgICAgICAgICAgICAgICBjb3VudEl0ZW1zID0gX3Jlc3VsdC5maW5kKCcuc2VhcmNoX19mb3VuZCcpLmZpbmQoJ2xpJykubGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgICAgIF9yZXN1bHQuYWRkQ2xhc3MoJ3Zpc2libGUnKTtcblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgX3Jlc3VsdC5yZW1vdmVDbGFzcygndmlzaWJsZScpO1xuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9hamF4UmVxdWVzdCA9ICBmdW5jdGlvbiggaW5wdXQsIG4gKSB7XG5cbiAgICAgICAgICAgICAgICBfcmVxdWVzdC5hYm9ydCgpO1xuICAgICAgICAgICAgICAgIF9yZXF1ZXN0ID0gJC5hamF4KCB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogX3BhdGgsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBpbnB1dC52YWwoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbjonbWFpbl9zZWFyY2gnXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiZ2V0XCIsXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uICggbXNnICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggT2JqZWN0LmtleXMobXNnKS5sZW5ndGggIT0gMCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYWRkRGF0YSggbXNnICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uIChYTUxIdHRwUmVxdWVzdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFhNTEh0dHBSZXF1ZXN0LnN0YXR1c1RleHQgIT0gXCJhYm9ydFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJFcnJvclwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICAgICAgX2luaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX2FkZEV2ZW50cygpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAvL3B1YmxpYyBwcm9wZXJ0aWVzXG5cbiAgICAgICAgLy9wdWJsaWMgbWV0aG9kc1xuXG4gICAgICAgIF9pbml0KCk7XG4gICAgfTtcblxufSApKCk7Il19
