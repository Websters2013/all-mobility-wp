!function(){$(function(){$(".site__menu").each(function(){new e($(this)),new n($(this))})});var e=function(e){var n=e,i=n.find(".site__menu-item"),d=n.find(".fa-chevron-down"),t=$(window),o=t.width(),a=function(){t.on({resize:function(){o>t.width()&&(o=t.width(),t.find(".opened").removeClass("opened"))}}),$("body").on("click",".fa-chevron-down",function(){if(jQuery(window).width()<1e3){var e=jQuery(this),n=e.parent("li");n.hasClass("opened")?n.removeClass("opened"):n.addClass("opened")}return!1}),d.on({click:function(){var e=jQuery(this),n=e.parent("li");return t.width()<1024&&(n.hasClass("opened")?n.removeClass("opened"):n.addClass("opened")),!1}}),i.on({mouseenter:function(){if(t.width()>=1024){var e=$(this);e.parent("ul");if(e.hasClass("site__menu-item_sub")){e.addClass("opened");var n=e.find(".site__menu-sub");t.width()-(n.innerWidth()+e.offset().left)<0?n.css({left:e.position().left-n.innerWidth()+e.innerWidth()}):n.css({left:e.position().left})}}}}),$("[data-product]").on({mouseenter:function(){if(t.width()>=1024){var e=$(this),i=e.data("product");console.log(i),n.find(".featured-product").find(".featured-product__title").text(i.name),n.find(".featured-product").find(".featured-product__pic img").attr("src",i.src),n.find(".featured-product").find(".btn").attr("url",i.href),n.find(".featured-product").find(".featured-product__price span").text(i.price),i.onSale?n.find(".featured-product").find(".featured-product__remark").addClass("visible"):n.find(".featured-product").find(".featured-product__remark").removeClass("visible"),i.oldPrice?n.find(".featured-product").find(".featured-product__price del").text(i.oldPrice):n.find(".featured-product").find(".featured-product__price del").addClass("hidden")}}}),n.on("mouseleave",function(){t.width()>=1024&&$(this).find(".opened").removeClass("opened")}),n.find("ul").on("mouseleave",function(){t.width()>=1024&&$(this).find(".opened").removeClass("opened")}),n.find("li").on("mouseleave",function(){t.width()>=1024&&$(this).removeClass("opened")})},s=function(){a()};s()},n=function(e){var n,i=this,d=e,t=$(window),o=!1,a=$(".site__header"),s=a.innerHeight(),r=$(".site__header-btn"),f=function(){r.on({click:function(){l($(this))}}),t.on({scroll:function(){c(),o=t.scrollTop()>=s},DOMMouseScroll:function(e){var n=e.originalEvent.detail;if(n){var i=n>0?1:-1;u(i)}},mousewheel:function(e){var n=e.originalEvent.wheelDelta;if(n){var i=n>0?-1:1;u(i)}},touchmove:function(e){var i=e.originalEvent.touches[0].clientY;i>n?u(-1):i<n&&u(1),n=i},keydown:function(e){switch(e.which){case 32:u(1);break;case 33:u(-1);break;case 34:u(1);break;case 35:u(1);break;case 36:u(-1);break;case 38:u(-1);break;case 40:u(1);break;default:return}}})},u=function(e){e>0&&!a.hasClass("site__header_hidden")&&!r.hasClass("opened")&&o&&a.addClass("site__header_hidden"),e<0&&a.hasClass("site__header_hidden")&&!r.hasClass("opened")&&o&&a.removeClass("site__header_hidden")},c=function(){t.scrollTop()>s?a.addClass("fixed"):a.removeClass("fixed")},l=function(e){var n=e;n.hasClass("opened")?n.removeClass("opened"):n.addClass("opened")},h=function(){d[0].obj=i,f()};h()}}();
"use strict";!function(){$(function(){$.each($(".product__slider"),function(){new e($(this))}),$.each($(".featured-products"),function(){new i($(this))})});var e=function(e){var i,n,t=this,o=e,s=function(){o[0].obj=t,r()},r=function(){i=new Swiper(o.find(".gallery-top"),{slidesPerView:"1",loop:!0,loopedSlides:o.find(".gallery-top .swiper-slide").length,centeredSlides:!1,spaceBetween:30}),n=new Swiper(o.find(".gallery-thumbs"),{centeredSlides:!1,loop:!0,loopedSlides:o.find(".gallery-thumbs .swiper-slide").length,slidesPerView:"4",touchRatio:.2,slideToClickedSlide:!0,breakpoints:{415:{slidesPerView:"3"},1440:{slidesPerView:"3"}}}),i.params.control=n,n.params.control=i};s()},i=function(e){var i,n,t=this,o=e,s=$(window),r=function(){o[0].obj=t,l()},l=function(){s.on({load:function(){s.width()<=768?n=!0:(n=!0,n&&(a(),n=!1))},resize:function(){s.width()<=768?n||(d(),n=!0):n&&(a(),n=!1)}})},d=function(){i.destroy(!0,!0)},a=function(){i=new Swiper(o.find(".swiper-container"),{pagination:o.find(".swiper-pagination"),slidesPerView:5,paginationClickable:!0,speed:600,autoplay:5e3,autoplayDisableOnInteraction:!1,nextButton:o.find(".swiper-button-next"),prevButton:o.find(".swiper-button-prev"),breakpoints:{1440:{slidesPerView:4}}})};r()}}();
!function(){$(function(){$("select").each(function(){new e({obj:$(this),optionType:1,showType:2})})});var e=function(e){var t,i,n=this,o=e.obj,s=e.optionType||0,c=e.showType||0,a=e.visible||5,l=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),p=$('<span class="websters-select__item"></span>'),d=$('<div class="websters-select"></div>'),r=$(window),f=$("body"),u=!1,h=function(){var e="";o.css({opacity:0}),o.wrap(d),d=o.parent(),d.append('<div class="websters-select__arrow"></div>'),o.before(p),o.find("option").each(function(){var t=$(this);"selected"==t.attr("selected")&&(e=t.text())}),""==e&&(e=o.find("option").eq(0).text()),p.text(e)},v=function(){u=!1,c?1==c?t.stop(!0,!1).slideUp(300,function(){t.remove()}):2==c&&t.stop(!0,!1).fadeOut(300,function(){t.remove()}):t.css({display:"none"}),d.removeClass("websters-select_opened")},b=function(){o[0].obj=n,h(),g(),w()},w=function(){o.on("change",function(){p.text($(this).find("option:selected").text())}),1!=s||l||(d.on({click:function(e){e.stopPropagation(),u?v():m()}}),r.on({click:function(){u&&v()}}))},g=function(){!s||l?y():1==s&&_()},_=function(){d.addClass("websters-select_custom")},y=function(){d.addClass("websters-select_mobile")},m=function(){var e=$("select"),n=$("<ul></ul>"),s=(r.scrollTop(),d.offset()),l=0,p=o.find("option:selected").index(),h=Math.round(1e3*Math.random());e.each(function(){this!==o[0]&&this.obj.checkOpened()&&this.obj.close()}),u&&t.remove(),u=!0,t=$('<div class="websters-select__popup" id="websters-select__popup'+h+'"></div>'),o.find("option").each(function(e){var t=$(this);e==p?n.append('<li class="active">'+t.text()+"</li>"):n.append("<li>"+t.text()+"</li>")}),t.append(n),f.append(t),d.addClass("websters-select_opened"),t.css({width:d.outerWidth(),left:s.left,top:s.top+d.outerHeight()}),l=t.outerHeight(),l>t.find("li").eq(0).outerHeight()*a&&(t.height(t.find("li").eq(0).outerHeight()*a),i=t.perfectScrollbar()),1==c?(t.css({display:"none"}),t.slideDown(300)):2==c&&(t.css({opacity:.1}),t.animate({opacity:1},300)),t.find("li").on({click:function(e){var t=$(this).index();e.stopPropagation(),o.val(o.find("option").eq(t).attr("value")),o.trigger("change"),v()}})};n.checkOpened=function(){return u},n.close=function(){v()},b()}}();
!function(){$(function(){$(".category__filters").each(function(){new i($(this))})});var i=function(i){var e=i,n=e.find(".category__filters-item span"),t=e.find(".category__filters-title"),s=e.find(".category__filters-items"),o=($(window),function(){n.on({click:function(){var i=$(this),e=i.parent(),n=i.next();e.hasClass("opened")?(e.removeClass("opened"),n.css({"min-height":0,height:0})):(e.addClass("opened"),n.css({"min-height":n.find(">div").innerHeight()}),setTimeout(function(){n.css({height:"auto"})},310))}}),t.on({click:function(){var i=$(this);i.hasClass("opened")?(i.removeClass("opened"),s.css({"min-height":0,height:0})):(i.addClass("opened"),s.css({"min-height":s.find(">div").innerHeight()}),setTimeout(function(){s.css({height:"auto"})},310))}})}),c=function(){o()};c()}}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS5tYWluLmpzIiwianF1ZXJ5LnByb2R1Y3Qtc2xpZGVyLmpzIiwianF1ZXJ5LndlYnN0ZXJzLXNlbGVjdC5qcyIsImpxdWVyeS5maWx0ZXJzLmpzIl0sIm5hbWVzIjpbIiQiLCJlYWNoIiwiU3ViTWVudSIsInRoaXMiLCJNZW51Iiwib2JqIiwiX29iaiIsIl9pdGVtcyIsImZpbmQiLCJfYXJyb3ciLCJfd2luZG93Iiwid2luZG93IiwiX3N0YXJ0V2luV2lkdGgiLCJ3aWR0aCIsIl9hZGRFdmVudHMiLCJvbiIsInJlc2l6ZSIsInJlbW92ZUNsYXNzIiwialF1ZXJ5IiwiY3VySXRlbSIsInBhcmVudCIsImhhc0NsYXNzIiwiYWRkQ2xhc3MiLCJjbGljayIsIm1vdXNlZW50ZXIiLCJzdWJNZW51IiwiaW5uZXJXaWR0aCIsIm9mZnNldCIsImxlZnQiLCJjc3MiLCJwb3NpdGlvbiIsImRhdGEiLCJjb25zb2xlIiwibG9nIiwidGV4dCIsIm5hbWUiLCJhdHRyIiwic3JjIiwiaHJlZiIsInByaWNlIiwib25TYWxlIiwib2xkUHJpY2UiLCJfaW5pdCIsIl9sYXN0UG9zIiwiX3NlbGYiLCJfbWVudSIsIl9hY3Rpb24iLCJfaGVhZGVyIiwiX2hlYWRlckhlaWdodCIsImlubmVySGVpZ2h0IiwiX3Nob3dCdG4iLCJfb3Blbk1lbnUiLCJzY3JvbGwiLCJfZml4ZWRIZWFkZXIiLCJzY3JvbGxUb3AiLCJET01Nb3VzZVNjcm9sbCIsImUiLCJkZWx0YSIsIm9yaWdpbmFsRXZlbnQiLCJkZXRhaWwiLCJkaXJlY3Rpb24iLCJfY2hlY2tTY3JvbGwiLCJtb3VzZXdoZWVsIiwid2hlZWxEZWx0YSIsInRvdWNobW92ZSIsImN1cnJlbnRQb3MiLCJ0b3VjaGVzIiwiY2xpZW50WSIsImtleWRvd24iLCJ3aGljaCIsImVsZW0iLCJQcm9kdWN0U2xpZGVyIiwiRmVhdHVyZWRQcm9kdWN0c1NsaWRlciIsIl9zbGlkZXIiLCJfZ2FsbGVyeVRodW1icyIsIl9jb25zdHJ1Y3RvciIsIl9pbml0U2xpZGVyIiwiU3dpcGVyIiwic2xpZGVzUGVyVmlldyIsImxvb3AiLCJsb29wZWRTbGlkZXMiLCJsZW5ndGgiLCJjZW50ZXJlZFNsaWRlcyIsInNwYWNlQmV0d2VlbiIsInRvdWNoUmF0aW8iLCJzbGlkZVRvQ2xpY2tlZFNsaWRlIiwiYnJlYWtwb2ludHMiLCI0MTUiLCIxNDQwIiwicGFyYW1zIiwiY29udHJvbCIsIl9mbGFnIiwibG9hZCIsIl9kZXN0cm95IiwiZGVzdHJveSIsInBhZ2luYXRpb24iLCJwYWdpbmF0aW9uQ2xpY2thYmxlIiwic3BlZWQiLCJhdXRvcGxheSIsImF1dG9wbGF5RGlzYWJsZU9uSW50ZXJhY3Rpb24iLCJuZXh0QnV0dG9uIiwicHJldkJ1dHRvbiIsIldlYnN0ZXJzU2VsZWN0Iiwib3B0aW9uVHlwZSIsInNob3dUeXBlIiwiX3BvcHVwIiwiX3Njcm9sbCIsIl9vcHRpb25UeXBlIiwiX3Nob3dUeXBlIiwiX3Zpc2libGUiLCJ2aXNpYmxlIiwiX2RldmljZSIsInRlc3QiLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiLCJfdGV4dCIsIl93cmFwIiwiX2JvZHkiLCJfb3BlbmVkIiwiX2FkZFdyYXAiLCJjdXJUZXh0Iiwib3BhY2l0eSIsIndyYXAiLCJhcHBlbmQiLCJiZWZvcmUiLCJlcSIsIl9oaWRlUG9wdXAiLCJzdG9wIiwic2xpZGVVcCIsInJlbW92ZSIsImZhZGVPdXQiLCJkaXNwbGF5IiwiX3NlbGVjdFZpZXdUeXBlIiwiX29uRXZlbnRzIiwic3RvcFByb3BhZ2F0aW9uIiwiX3Nob3dQb3B1cCIsIl9zZXRNb2JpbGVWaWV3IiwiX3NldEN1c3RvbTEiLCJzZWxlY3RzIiwibGlzdCIsIm1heEhlaWdodCIsImN1ckluZGV4IiwiaW5kZXgiLCJpZCIsIk1hdGgiLCJyb3VuZCIsInJhbmRvbSIsImNoZWNrT3BlbmVkIiwiY2xvc2UiLCJpIiwib3V0ZXJXaWR0aCIsInRvcCIsIm91dGVySGVpZ2h0IiwiaGVpZ2h0IiwicGVyZmVjdFNjcm9sbGJhciIsInNsaWRlRG93biIsImFuaW1hdGUiLCJ2YWwiLCJ0cmlnZ2VyIiwiRmlsdGVycyIsIl9idG4iLCJfYnRuMiIsIl9maWx0ZXJzIiwibmV4dEZpbHRlcnMiLCJuZXh0IiwibWluLWhlaWdodCIsInNldFRpbWVvdXQiXSwibWFwcGluZ3MiOiJDQUFBLFdBRUlBLEVBQUUsV0FFRUEsRUFBRSxlQUFlQyxLQUFLLFdBRWxCLEdBQUlDLEdBQVNGLEVBQUVHLE9BQ2YsR0FBSUMsR0FBTUosRUFBRUcsVUFNcEIsSUFBSUQsR0FBVSxTQUFVRyxHQUdwQixHQUFJQyxHQUFPRCxFQUNQRSxFQUFTRCxFQUFLRSxLQUFLLG9CQUNuQkMsRUFBU0gsRUFBS0UsS0FBSyxvQkFDbkJFLEVBQVVWLEVBQUVXLFFBQ1pDLEVBQWlCRixFQUFRRyxRQUl6QkMsRUFBYSxXQUVUSixFQUFRSyxJQUNKQyxPQUFRLFdBRUFKLEVBQWlCRixFQUFRRyxVQUV6QkQsRUFBaUJGLEVBQVFHLFFBRXpCSCxFQUFRRixLQUFLLFdBQVdTLFlBQVksY0FPaERqQixFQUFFLFFBQVFlLEdBQUcsUUFBUyxtQkFBb0IsV0FFdEMsR0FBSUcsT0FBT1AsUUFBUUUsUUFBVSxJQUFPLENBRWhDLEdBQUlNLEdBQVVELE9BQU9mLE1BQ2pCaUIsRUFBU0QsRUFBUUMsT0FBTyxLQUV2QkEsR0FBT0MsU0FBUyxVQUVqQkQsRUFBT0gsWUFBWSxVQUluQkcsRUFBT0UsU0FBUyxVQU14QixPQUFPLElBR1hiLEVBQU9NLElBQ0hRLE1BQU8sV0FFSCxHQUFJSixHQUFVRCxPQUFPZixNQUNqQmlCLEVBQVNELEVBQVFDLE9BQU8sS0FlNUIsT0FiSVYsR0FBUUcsUUFBVSxPQUNiTyxFQUFPQyxTQUFTLFVBRWpCRCxFQUFPSCxZQUFZLFVBSW5CRyxFQUFPRSxTQUFTLFlBTWpCLEtBR2ZmLEVBQU9RLElBQ0hTLFdBQVksV0FFUixHQUFJZCxFQUFRRyxTQUFXLEtBQU8sQ0FFMUIsR0FBSU0sR0FBVW5CLEVBQUVHLEtBQ0hnQixHQUFRQyxPQUFPLEtBRTVCLElBQUlELEVBQVFFLFNBQVMsdUJBQXlCLENB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bEosSUFDRlEsTUFBTyxXQUVILEdBQUlKLEdBQVVuQixFQUFFRyxLQUVaZ0IsR0FBUUUsU0FBUyxXQUVqQkYsRUFBUUYsWUFBWSxVQUNwQmlKLEVBQVNySSxLQUNMd0ksYUFBYyxFQUNkWixPQUFRLE1BS1p0SSxFQUFRRyxTQUFTLFVBQ2pCNEksRUFBU3JJLEtBQ0x3SSxhQUFjSCxFQUFTMUosS0FBSyxRQUFReUMsZ0JBR3hDcUgsV0FBWSxXQUVSSixFQUFTckksS0FDTDRILE9BQVUsVUFHZixXQVFuQi9HLEVBQVEsV0FDSjVCLElBT1I0QiIsImZpbGUiOiJjYXRlZ29yeS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoIGZ1bmN0aW9uKCl7XG5cbiAgICAkKGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAkKCcuc2l0ZV9fbWVudScpLmVhY2goZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICBuZXcgU3ViTWVudSggJCh0aGlzKSApO1xuICAgICAgICAgICAgbmV3IE1lbnUoICQodGhpcykgKTtcblxuICAgICAgICB9ICk7XG5cbiAgICB9ICk7XG5cbiAgICB2YXIgU3ViTWVudSA9IGZ1bmN0aW9uIChvYmopIHtcblxuICAgICAgICAvL3ByaXZhdGUgcHJvcGVydGllc1xuICAgICAgICB2YXIgX29iaiA9IG9iaixcbiAgICAgICAgICAgIF9pdGVtcyA9IF9vYmouZmluZCgnLnNpdGVfX21lbnUtaXRlbScpLFxuICAgICAgICAgICAgX2Fycm93ID0gX29iai5maW5kKCcuZmEtY2hldnJvbi1kb3duJyksXG4gICAgICAgICAgICBfd2luZG93ID0gJCh3aW5kb3cpLFxuICAgICAgICAgICAgX3N0YXJ0V2luV2lkdGggPSBfd2luZG93LndpZHRoKCk7XG5cbiAgICAgICAgLy9wcml2YXRlIG1ldGhvZHNcblxuICAgICAgICB2YXIgX2FkZEV2ZW50cyA9IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIF93aW5kb3cub24oIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzaXplOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBfc3RhcnRXaW5XaWR0aCA+IF93aW5kb3cud2lkdGgoKSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9zdGFydFdpbldpZHRoID0gX3dpbmRvdy53aWR0aCgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3dpbmRvdy5maW5kKCcub3BlbmVkJykucmVtb3ZlQ2xhc3MoJ29wZW5lZCcpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgICQoJ2JvZHknKS5vbignY2xpY2snLCAnLmZhLWNoZXZyb24tZG93bicsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKCBqUXVlcnkod2luZG93KS53aWR0aCgpIDwgMTAwMCApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1ckl0ZW0gPSBqUXVlcnkodGhpcyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50ID0gY3VySXRlbS5wYXJlbnQoJ2xpJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggcGFyZW50Lmhhc0NsYXNzKCdvcGVuZWQnKSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC5yZW1vdmVDbGFzcygnb3BlbmVkJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQuYWRkQ2xhc3MoJ29wZW5lZCcpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIF9hcnJvdy5vbigge1xuICAgICAgICAgICAgICAgICAgICBjbGljazogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VySXRlbSA9IGpRdWVyeSh0aGlzKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQgPSBjdXJJdGVtLnBhcmVudCgnbGknKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIF93aW5kb3cud2lkdGgoKSA8IDEwMjQgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBwYXJlbnQuaGFzQ2xhc3MoJ29wZW5lZCcpICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC5yZW1vdmVDbGFzcygnb3BlbmVkJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC5hZGRDbGFzcygnb3BlbmVkJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgIF9pdGVtcy5vbigge1xuICAgICAgICAgICAgICAgICAgICBtb3VzZWVudGVyOiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIF93aW5kb3cud2lkdGgoKSA+PSAxMDI0ICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1ckl0ZW0gPSAkKHRoaXMpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQgPSBjdXJJdGVtLnBhcmVudCgndWwnKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBjdXJJdGVtLmhhc0NsYXNzKCdzaXRlX19tZW51LWl0ZW1fc3ViJykgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VySXRlbS5hZGRDbGFzcygnb3BlbmVkJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Yk1lbnUgPSBjdXJJdGVtLmZpbmQoJy5zaXRlX19tZW51LXN1YicpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCAoIF93aW5kb3cud2lkdGgoKSAtICggc3ViTWVudS5pbm5lcldpZHRoKCkgKyBjdXJJdGVtLm9mZnNldCgpLmxlZnQgKSApIDwgMCApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViTWVudS5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiBjdXJJdGVtLnBvc2l0aW9uKCkubGVmdCAtIHN1Yk1lbnUuaW5uZXJXaWR0aCgpICsgY3VySXRlbS5pbm5lcldpZHRoKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJNZW51LmNzcygge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6IGN1ckl0ZW0ucG9zaXRpb24oKS5sZWZ0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgICAgICAkKCdbZGF0YS1wcm9kdWN0XScpLm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIG1vdXNlZW50ZXI6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggX3dpbmRvdy53aWR0aCgpID49IDEwMjQgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VySXRlbSA9ICQodGhpcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IGN1ckl0ZW0uZGF0YSgncHJvZHVjdCcpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfb2JqLmZpbmQoJy5mZWF0dXJlZC1wcm9kdWN0JykuZmluZCgnLmZlYXR1cmVkLXByb2R1Y3RfX3RpdGxlJykudGV4dChkYXRhLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9vYmouZmluZCgnLmZlYXR1cmVkLXByb2R1Y3QnKS5maW5kKCcuZmVhdHVyZWQtcHJvZHVjdF9fcGljIGltZycpLmF0dHIoJ3NyYycsIGRhdGEuc3JjKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfb2JqLmZpbmQoJy5mZWF0dXJlZC1wcm9kdWN0JykuZmluZCgnLmJ0bicpLmF0dHIoJ3VybCcsIGRhdGEuaHJlZik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX29iai5maW5kKCcuZmVhdHVyZWQtcHJvZHVjdCcpLmZpbmQoJy5mZWF0dXJlZC1wcm9kdWN0X19wcmljZSBzcGFuJykudGV4dChkYXRhLnByaWNlKTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIGRhdGEub25TYWxlICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfb2JqLmZpbmQoJy5mZWF0dXJlZC1wcm9kdWN0JykuZmluZCgnLmZlYXR1cmVkLXByb2R1Y3RfX3JlbWFyaycpLmFkZENsYXNzKCd2aXNpYmxlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX29iai5maW5kKCcuZmVhdHVyZWQtcHJvZHVjdCcpLmZpbmQoJy5mZWF0dXJlZC1wcm9kdWN0X19yZW1hcmsnKS5yZW1vdmVDbGFzcygndmlzaWJsZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBkYXRhLm9sZFByaWNlICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfb2JqLmZpbmQoJy5mZWF0dXJlZC1wcm9kdWN0JykuZmluZCgnLmZlYXR1cmVkLXByb2R1Y3RfX3ByaWNlIGRlbCcpLnRleHQoZGF0YS5vbGRQcmljZSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9vYmouZmluZCgnLmZlYXR1cmVkLXByb2R1Y3QnKS5maW5kKCcuZmVhdHVyZWQtcHJvZHVjdF9fcHJpY2UgZGVsJykuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgX29iai5vbiggJ21vdXNlbGVhdmUnLCBmdW5jdGlvbigpe1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKCBfd2luZG93LndpZHRoKCkgPj0gMTAyNCApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5maW5kKCcub3BlbmVkJykucmVtb3ZlQ2xhc3MoJ29wZW5lZCcpO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgICAgICBfb2JqLmZpbmQoJ3VsJykub24oICdtb3VzZWxlYXZlJywgZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgICAgICAgICBpZiggX3dpbmRvdy53aWR0aCgpID49IDEwMjQgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykuZmluZCgnLm9wZW5lZCcpLnJlbW92ZUNsYXNzKCdvcGVuZWQnKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgX29iai5maW5kKCdsaScpLm9uKCAnbW91c2VsZWF2ZScsIGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYoIF93aW5kb3cud2lkdGgoKSA+PSAxMDI0ICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCdvcGVuZWQnKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfYWRkRXZlbnRzKCk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIC8vcHVibGljIHByb3BlcnRpZXNcblxuICAgICAgICAvL3B1YmxpYyBtZXRob2RzXG5cbiAgICAgICAgX2luaXQoKTtcbiAgICB9O1xuICAgIHZhciBNZW51ID0gZnVuY3Rpb24gKG9iaikge1xuXG4gICAgICAgIC8vcHJpdmF0ZSBwcm9wZXJ0aWVzXG4gICAgICAgIHZhciBfc2VsZiA9IHRoaXMsXG4gICAgICAgICAgICBfbWVudSA9IG9iaixcbiAgICAgICAgICAgIF93aW5kb3cgPSAkKHdpbmRvdyksXG4gICAgICAgICAgICBfYWN0aW9uID0gZmFsc2UsXG4gICAgICAgICAgICBfbGFzdFBvcyxcbiAgICAgICAgICAgIF9oZWFkZXIgPSAkKCcuc2l0ZV9faGVhZGVyJyksXG4gICAgICAgICAgICBfaGVhZGVySGVpZ2h0ID0gX2hlYWRlci5pbm5lckhlaWdodCgpLFxuICAgICAgICAgICAgX3Nob3dCdG4gPSAkKCcuc2l0ZV9faGVhZGVyLWJ0bicpO1xuXG4gICAgICAgIC8vcHJpdmF0ZSBtZXRob2RzXG4gICAgICAgIHZhciBfYWRkRXZlbnRzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgX3Nob3dCdG4ub24oe1xuICAgICAgICAgICAgICAgICAgICBjbGljazogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfb3Blbk1lbnUoJCh0aGlzKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgX3dpbmRvdy5vbigge1xuICAgICAgICAgICAgICAgICAgICBzY3JvbGw6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9maXhlZEhlYWRlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2FjdGlvbiA9IF93aW5kb3cuc2Nyb2xsVG9wKCkgPj0gX2hlYWRlckhlaWdodDtcblxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBET01Nb3VzZVNjcm9sbDogZnVuY3Rpb24gKGUpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRlbHRhID0gZS5vcmlnaW5hbEV2ZW50LmRldGFpbDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRlbHRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRpcmVjdGlvbiA9IChkZWx0YSA+IDApID8gMSA6IC0xO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NoZWNrU2Nyb2xsKGRpcmVjdGlvbik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBtb3VzZXdoZWVsOiBmdW5jdGlvbiAoZSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVsdGEgPSBlLm9yaWdpbmFsRXZlbnQud2hlZWxEZWx0YTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRlbHRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRpcmVjdGlvbiA9IChkZWx0YSA+IDApID8gLTEgOiAxO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NoZWNrU2Nyb2xsKGRpcmVjdGlvbik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB0b3VjaG1vdmU6IGZ1bmN0aW9uIChlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50UG9zID0gZS5vcmlnaW5hbEV2ZW50LnRvdWNoZXNbMF0uY2xpZW50WTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRQb3MgPiBfbGFzdFBvcykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NoZWNrU2Nyb2xsKC0xKTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGN1cnJlbnRQb3MgPCBfbGFzdFBvcykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NoZWNrU2Nyb2xsKDEpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9sYXN0UG9zID0gY3VycmVudFBvcztcblxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBrZXlkb3duOiBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChlLndoaWNoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDMyOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY2hlY2tTY3JvbGwoMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzM6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jaGVja1Njcm9sbCgtMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzQgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY2hlY2tTY3JvbGwoMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzUgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY2hlY2tTY3JvbGwoMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzYgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY2hlY2tTY3JvbGwoLTEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM4OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY2hlY2tTY3JvbGwoLTEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY2hlY2tTY3JvbGwoMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9jaGVja1Njcm9sbCA9IGZ1bmN0aW9uIChkaXJlY3Rpb24pIHtcblxuICAgICAgICAgICAgICAgIGlmIChkaXJlY3Rpb24gPiAwICYmICFfaGVhZGVyLmhhc0NsYXNzKCdzaXRlX19oZWFkZXJfaGlkZGVuJykgJiYgIV9zaG93QnRuLmhhc0NsYXNzKCdvcGVuZWQnKSAmJiBfYWN0aW9uKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgX2hlYWRlci5hZGRDbGFzcygnc2l0ZV9faGVhZGVyX2hpZGRlbicpO1xuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGRpcmVjdGlvbiA8IDAgJiYgX2hlYWRlci5oYXNDbGFzcygnc2l0ZV9faGVhZGVyX2hpZGRlbicpICYmICFfc2hvd0J0bi5oYXNDbGFzcygnb3BlbmVkJykgJiYgX2FjdGlvbikge1xuXG4gICAgICAgICAgICAgICAgICAgIF9oZWFkZXIucmVtb3ZlQ2xhc3MoJ3NpdGVfX2hlYWRlcl9oaWRkZW4nKTtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9maXhlZEhlYWRlciA9IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIGlmIChfd2luZG93LnNjcm9sbFRvcCgpID4gX2hlYWRlckhlaWdodCAgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9zZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9oZWFkZXIuYWRkQ2xhc3MoJ2ZpeGVkJyk7XG4gICAgICAgICAgICAgICAgICAgIC8vfSwgNTAwICk7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgIC8vX2hlYWRlci5yZW1vdmVDbGFzcygnZml4ZWQnKTtcblxuICAgICAgICAgICAgICAgICAgICAvL3NldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX2hlYWRlci5yZW1vdmVDbGFzcygnZml4ZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgLy99LCA1MTAgKTtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9vcGVuTWVudSA9IGZ1bmN0aW9uIChlbGVtKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgY3VySXRlbSA9IGVsZW07XG5cbiAgICAgICAgICAgICAgICBpZiAoY3VySXRlbS5oYXNDbGFzcygnb3BlbmVkJykpIHtcblxuICAgICAgICAgICAgICAgICAgICBjdXJJdGVtLnJlbW92ZUNsYXNzKCdvcGVuZWQnKTtcblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgY3VySXRlbS5hZGRDbGFzcygnb3BlbmVkJyk7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfbWVudVswXS5vYmogPSBfc2VsZjtcbiAgICAgICAgICAgICAgICBfYWRkRXZlbnRzKCk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIF9pbml0KCk7XG4gICAgfTtcblxufSApKCk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG4oIGZ1bmN0aW9uKCkge1xuXG4gICAgJCggZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgJC5lYWNoKCAkKCAnLnByb2R1Y3RfX3NsaWRlcicgKSwgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIG5ldyBQcm9kdWN0U2xpZGVyICggJCggdGhpcyApICk7XG5cbiAgICAgICAgfSApO1xuXG4gICAgICAgICQuZWFjaCggJCggJy5mZWF0dXJlZC1wcm9kdWN0cycgKSwgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIG5ldyBGZWF0dXJlZFByb2R1Y3RzU2xpZGVyICggJCggdGhpcyApICk7XG5cbiAgICAgICAgfSApO1xuICAgIH0pO1xuXG4gICAgdmFyIFByb2R1Y3RTbGlkZXIgPSBmdW5jdGlvbiggb2JqICkge1xuXG4gICAgICAgIC8vcHJpdmF0ZSBwcm9wZXJ0aWVzXG4gICAgICAgIHZhciBfc2VsZiA9IHRoaXMsXG4gICAgICAgICAgICBfb2JqID0gb2JqLFxuICAgICAgICAgICAgX3NsaWRlcixcbiAgICAgICAgICAgIF9nYWxsZXJ5VGh1bWJzO1xuXG4gICAgICAgIC8vcHJpdmF0ZSBtZXRob2RzXG4gICAgICAgIHZhciBfY29uc3RydWN0b3IgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBfb2JqWyAwIF0ub2JqID0gX3NlbGY7XG4gICAgICAgICAgICAgICAgX2luaXRTbGlkZXIoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaW5pdFNsaWRlciA9IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIF9zbGlkZXIgPSBuZXcgU3dpcGVyKCBfb2JqLmZpbmQoJy5nYWxsZXJ5LXRvcCcpICwge1xuICAgICAgICAgICAgICAgICAgICBzbGlkZXNQZXJWaWV3OiAnMScsXG4gICAgICAgICAgICAgICAgICAgIGxvb3A6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGxvb3BlZFNsaWRlczogX29iai5maW5kKCcuZ2FsbGVyeS10b3AgLnN3aXBlci1zbGlkZScpLmxlbmd0aCxcbiAgICAgICAgICAgICAgICAgICAgLy9hdXRvcGxheTogNDAwMCxcbiAgICAgICAgICAgICAgICAgICAgY2VudGVyZWRTbGlkZXM6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBzcGFjZUJldHdlZW46IDMwXG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgX2dhbGxlcnlUaHVtYnMgPSBuZXcgU3dpcGVyKCBfb2JqLmZpbmQoJy5nYWxsZXJ5LXRodW1icycpLCB7XG4gICAgICAgICAgICAgICAgICAgIGNlbnRlcmVkU2xpZGVzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgbG9vcDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgLy9hdXRvcGxheTogNDAwMCxcbiAgICAgICAgICAgICAgICAgICAgbG9vcGVkU2xpZGVzOiBfb2JqLmZpbmQoJy5nYWxsZXJ5LXRodW1icyAuc3dpcGVyLXNsaWRlJykubGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICBzbGlkZXNQZXJWaWV3OiAnNCcsXG4gICAgICAgICAgICAgICAgICAgIHRvdWNoUmF0aW86IDAuMixcbiAgICAgICAgICAgICAgICAgICAgc2xpZGVUb0NsaWNrZWRTbGlkZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtwb2ludHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIDQxNToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsaWRlc1BlclZpZXc6ICczJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIDE0NDA6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbGlkZXNQZXJWaWV3OiAnMydcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgX3NsaWRlci5wYXJhbXMuY29udHJvbCA9IF9nYWxsZXJ5VGh1bWJzO1xuICAgICAgICAgICAgICAgIF9nYWxsZXJ5VGh1bWJzLnBhcmFtcy5jb250cm9sID0gX3NsaWRlcjtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgX2NvbnN0cnVjdG9yKCk7XG4gICAgfTtcbiAgICB2YXIgRmVhdHVyZWRQcm9kdWN0c1NsaWRlciA9IGZ1bmN0aW9uKCBvYmogKSB7XG5cbiAgICAgICAgLy9wcml2YXRlIHByb3BlcnRpZXNcbiAgICAgICAgdmFyIF9zZWxmID0gdGhpcyxcbiAgICAgICAgICAgIF9vYmogPSBvYmosXG4gICAgICAgICAgICBfc2xpZGVyLFxuICAgICAgICAgICAgX3dpbmRvdyA9ICQod2luZG93KSxcbiAgICAgICAgICAgIF9mbGFnO1xuXG4gICAgICAgIC8vcHJpdmF0ZSBtZXRob2RzXG4gICAgICAgIHZhciBfY29uc3RydWN0b3IgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBfb2JqWyAwIF0ub2JqID0gX3NlbGY7XG4gICAgICAgICAgICAgICAgX2FkZEV2ZW50cygpO1xuICAgICAgICAgICAgICAgIC8vX2luaXRTbGlkZXIoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfYWRkRXZlbnRzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgX3dpbmRvdy5vbigge1xuICAgICAgICAgICAgICAgICAgICBsb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBfd2luZG93LndpZHRoKCkgPD0gNzY4ICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2ZsYWcgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2ZsYWcgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIF9mbGFnICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaW5pdFNsaWRlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZmxhZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHJlc2l6ZTogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggX3dpbmRvdy53aWR0aCgpIDw9IDc2OCApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vX2ZsYWcgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCAhX2ZsYWcgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9mbGFnID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL19mbGFnID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBfZmxhZyApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2luaXRTbGlkZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2ZsYWcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2Rlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICBfc2xpZGVyLmRlc3Ryb3kodHJ1ZSwgdHJ1ZSk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaW5pdFNsaWRlciA9IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIF9zbGlkZXIgPSBuZXcgU3dpcGVyKCBfb2JqLmZpbmQoICcuc3dpcGVyLWNvbnRhaW5lcicgKSwge1xuICAgICAgICAgICAgICAgICAgICBwYWdpbmF0aW9uOiBfb2JqLmZpbmQoJy5zd2lwZXItcGFnaW5hdGlvbicpLFxuICAgICAgICAgICAgICAgICAgICBzbGlkZXNQZXJWaWV3OiA1LFxuICAgICAgICAgICAgICAgICAgICBwYWdpbmF0aW9uQ2xpY2thYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBzcGVlZDogNjAwLFxuICAgICAgICAgICAgICAgICAgICAvL2xvb3A6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGF1dG9wbGF5OiA1MDAwLFxuICAgICAgICAgICAgICAgICAgICBhdXRvcGxheURpc2FibGVPbkludGVyYWN0aW9uOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgbmV4dEJ1dHRvbjogX29iai5maW5kKCcuc3dpcGVyLWJ1dHRvbi1uZXh0JyksXG4gICAgICAgICAgICAgICAgICAgIHByZXZCdXR0b246IF9vYmouZmluZCgnLnN3aXBlci1idXR0b24tcHJldicpLFxuICAgICAgICAgICAgICAgICAgICBicmVha3BvaW50czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgMTQ0MDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsaWRlc1BlclZpZXc6IDRcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgX2NvbnN0cnVjdG9yKCk7XG4gICAgfTtcblxufSApKCk7XG4iLCIoIGZ1bmN0aW9uKCl7XG5cbiAgICAkKCBmdW5jdGlvbigpe1xuICAgICAgICAkKCAnc2VsZWN0JyApLmVhY2goIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBuZXcgV2Vic3RlcnNTZWxlY3QoIHtcbiAgICAgICAgICAgICAgICBvYmo6ICQoIHRoaXMgKSxcbiAgICAgICAgICAgICAgICBvcHRpb25UeXBlOiAxLFxuICAgICAgICAgICAgICAgIHNob3dUeXBlOiAyXG4gICAgICAgICAgICB9ICk7XG4gICAgICAgIH0gKTtcbiAgICB9ICk7XG5cbiAgICB2YXIgV2Vic3RlcnNTZWxlY3QgPSBmdW5jdGlvbiggcGFyYW1zICl7XG5cbiAgICAgICAgLy9wcml2YXRlIHByb3BlcnRpZXNcbiAgICAgICAgdmFyIF9zZWxmID0gdGhpcyxcbiAgICAgICAgICAgIF9vYmogPSBwYXJhbXMub2JqLFxuICAgICAgICAgICAgX29wdGlvblR5cGUgPSBwYXJhbXMub3B0aW9uVHlwZSB8fCAwLFxuICAgICAgICAgICAgX3Nob3dUeXBlID0gcGFyYW1zLnNob3dUeXBlIHx8IDAsXG4gICAgICAgICAgICBfdmlzaWJsZSA9IHBhcmFtcy52aXNpYmxlIHx8IDUsXG4gICAgICAgICAgICBfZGV2aWNlID0gL0FuZHJvaWR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxCbGFja0JlcnJ5fElFTW9iaWxlfE9wZXJhIE1pbmkvaS50ZXN0KCBuYXZpZ2F0b3IudXNlckFnZW50ICksXG4gICAgICAgICAgICBfdGV4dCA9ICQoICc8c3BhbiBjbGFzcz1cIndlYnN0ZXJzLXNlbGVjdF9faXRlbVwiPjwvc3Bhbj4nICksXG4gICAgICAgICAgICBfd3JhcCA9ICQoICc8ZGl2IGNsYXNzPVwid2Vic3RlcnMtc2VsZWN0XCI+PC9kaXY+JyApLFxuICAgICAgICAgICAgX3dpbmRvdyA9ICQoIHdpbmRvdyApLFxuICAgICAgICAgICAgX2JvZHkgPSAkKCAnYm9keScgKSxcbiAgICAgICAgICAgIF9vcGVuZWQgPSBmYWxzZSxcbiAgICAgICAgICAgIF9wb3B1cCwgX3Njcm9sbDtcblxuICAgICAgICAvL3ByaXZhdGUgbWV0aG9kc1xuICAgICAgICB2YXIgX2FkZFdyYXAgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIHZhciBjdXJUZXh0ID0gJyc7XG5cbiAgICAgICAgICAgICAgICBfb2JqLmNzcygge1xuICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiAwXG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgX29iai53cmFwKCBfd3JhcCApO1xuICAgICAgICAgICAgICAgIF93cmFwID0gX29iai5wYXJlbnQoKTtcbiAgICAgICAgICAgICAgICBfd3JhcC5hcHBlbmQoICc8ZGl2IGNsYXNzPVwid2Vic3RlcnMtc2VsZWN0X19hcnJvd1wiPjwvZGl2PicgKTtcbiAgICAgICAgICAgICAgICBfb2JqLmJlZm9yZSggX3RleHQgKTtcbiAgICAgICAgICAgICAgICBfb2JqLmZpbmQoICdvcHRpb24nICkuZWFjaCggZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1ckl0ZW0gPSAkKCB0aGlzICk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYoIGN1ckl0ZW0uYXR0ciggJ3NlbGVjdGVkJyApID09ICdzZWxlY3RlZCcgKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1clRleHQgPSBjdXJJdGVtLnRleHQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgIGlmKCBjdXJUZXh0ID09ICcnICl7XG4gICAgICAgICAgICAgICAgICAgIGN1clRleHQgPSAgX29iai5maW5kKCAnb3B0aW9uJykuZXEoIDAgKS50ZXh0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF90ZXh0LnRleHQoIGN1clRleHQgKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaGlkZVBvcHVwID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBfb3BlbmVkID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICBpZiggIV9zaG93VHlwZSApe1xuICAgICAgICAgICAgICAgICAgICBfcG9wdXAuY3NzKCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiAnbm9uZSdcbiAgICAgICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiggX3Nob3dUeXBlID09IDEgKXtcbiAgICAgICAgICAgICAgICAgICAgX3BvcHVwLnN0b3AoIHRydWUsIGZhbHNlICkuc2xpZGVVcCggMzAwLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgX3BvcHVwLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmKCBfc2hvd1R5cGUgPT0gMiApIHtcbiAgICAgICAgICAgICAgICAgICAgX3BvcHVwLnN0b3AoIHRydWUsIGZhbHNlICkuZmFkZU91dCggMzAwLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgX3BvcHVwLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgX3dyYXAucmVtb3ZlQ2xhc3MoICd3ZWJzdGVycy1zZWxlY3Rfb3BlbmVkJyApO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2NvbnN0cnVjdG9yID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBfb2JqWyAwIF0ub2JqID0gX3NlbGY7XG5cbiAgICAgICAgICAgICAgICBfYWRkV3JhcCgpO1xuICAgICAgICAgICAgICAgIF9zZWxlY3RWaWV3VHlwZSgpO1xuICAgICAgICAgICAgICAgIF9vbkV2ZW50cygpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9vbkV2ZW50cyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgX29iai5vbiggJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBfdGV4dC50ZXh0KCAkKCB0aGlzICkuZmluZCggJ29wdGlvbjpzZWxlY3RlZCcgKS50ZXh0KCkgKTtcbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICBpZiggX29wdGlvblR5cGUgPT0gMSAmJiAhX2RldmljZSApe1xuICAgICAgICAgICAgICAgICAgICBfd3JhcC5vbigge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2NsaWNrJzogZnVuY3Rpb24oIGUgKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIF9vcGVuZWQgKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2hpZGVQb3B1cCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9zaG93UG9wdXAoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgICAgIF93aW5kb3cub24oIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdjbGljayc6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIF9vcGVuZWQgKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2hpZGVQb3B1cCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfc2VsZWN0Vmlld1R5cGUgPSBmdW5jdGlvbigpe1xuXG4gICAgICAgICAgICAgICAgaWYoICFfb3B0aW9uVHlwZSB8fCBfZGV2aWNlICl7XG4gICAgICAgICAgICAgICAgICAgIF9zZXRNb2JpbGVWaWV3KCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmKCBfb3B0aW9uVHlwZSA9PSAxICl7XG4gICAgICAgICAgICAgICAgICAgIF9zZXRDdXN0b20xKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9zZXRDdXN0b20xID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBfd3JhcC5hZGRDbGFzcyggJ3dlYnN0ZXJzLXNlbGVjdF9jdXN0b20nICk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX3NldE1vYmlsZVZpZXcgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIF93cmFwLmFkZENsYXNzKCAnd2Vic3RlcnMtc2VsZWN0X21vYmlsZScgKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfc2hvd1BvcHVwID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICB2YXIgc2VsZWN0cyA9ICQoICdzZWxlY3QnICksXG4gICAgICAgICAgICAgICAgICAgIGxpc3QgPSAkKCAnPHVsPjwvdWw+JyksXG4gICAgICAgICAgICAgICAgICAgIGN1clNjcm9sbCA9IF93aW5kb3cuc2Nyb2xsVG9wKCksXG4gICAgICAgICAgICAgICAgICAgIG9mZnNldCA9IF93cmFwLm9mZnNldCgpLFxuICAgICAgICAgICAgICAgICAgICBtYXhIZWlnaHQgPSAwLFxuICAgICAgICAgICAgICAgICAgICBjdXJJbmRleCA9IF9vYmouZmluZCggJ29wdGlvbjpzZWxlY3RlZCcgKS5pbmRleCgpLFxuICAgICAgICAgICAgICAgICAgICBpZCA9IE1hdGgucm91bmQoIE1hdGgucmFuZG9tKCkgKiAxMDAwICk7XG5cbiAgICAgICAgICAgICAgICBzZWxlY3RzLmVhY2goIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgIGlmKCB0aGlzICE9PSBfb2JqWyAwIF0gJiYgdGhpcy5vYmouY2hlY2tPcGVuZWQoKSApe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vYmouY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgIGlmKCBfb3BlbmVkICl7XG4gICAgICAgICAgICAgICAgICAgIF9wb3B1cC5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgX29wZW5lZCA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICBfcG9wdXAgPSAkKCAnPGRpdiBjbGFzcz1cIndlYnN0ZXJzLXNlbGVjdF9fcG9wdXBcIiBpZD1cIndlYnN0ZXJzLXNlbGVjdF9fcG9wdXAnICsgaWQgKyAnXCI+PC9kaXY+JyApO1xuXG4gICAgICAgICAgICAgICAgX29iai5maW5kKCAnb3B0aW9uJyApLmVhY2goIGZ1bmN0aW9uKCBpICl7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjdXJJdGVtID0gJCggdGhpcyApO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKCBpID09IGN1ckluZGV4ICl7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaXN0LmFwcGVuZCggJzxsaSBjbGFzcz1cImFjdGl2ZVwiPicgKyBjdXJJdGVtLnRleHQoKSArICc8L2xpPicgKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QuYXBwZW5kKCAnPGxpPicgKyBjdXJJdGVtLnRleHQoKSArICc8L2xpPicgKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgX3BvcHVwLmFwcGVuZCggbGlzdCApO1xuICAgICAgICAgICAgICAgIF9ib2R5LmFwcGVuZCggX3BvcHVwICk7XG4gICAgICAgICAgICAgICAgX3dyYXAuYWRkQ2xhc3MoICd3ZWJzdGVycy1zZWxlY3Rfb3BlbmVkJyApO1xuXG4gICAgICAgICAgICAgICAgX3BvcHVwLmNzcygge1xuICAgICAgICAgICAgICAgICAgICB3aWR0aDogX3dyYXAub3V0ZXJXaWR0aCgpLFxuICAgICAgICAgICAgICAgICAgICBsZWZ0OiBvZmZzZXQubGVmdCxcbiAgICAgICAgICAgICAgICAgICAgdG9wOiBvZmZzZXQudG9wICsgX3dyYXAub3V0ZXJIZWlnaHQoKVxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgIG1heEhlaWdodCA9IF9wb3B1cC5vdXRlckhlaWdodCgpO1xuICAgICAgICAgICAgICAgIGlmKCBtYXhIZWlnaHQgPiBfcG9wdXAuZmluZCggJ2xpJyApLmVxKCAwICkub3V0ZXJIZWlnaHQoKSAqIF92aXNpYmxlICl7XG4gICAgICAgICAgICAgICAgICAgIF9wb3B1cC5oZWlnaHQoIF9wb3B1cC5maW5kKCAnbGknICkuZXEoIDAgKS5vdXRlckhlaWdodCgpICogX3Zpc2libGUgKTtcbiAgICAgICAgICAgICAgICAgICAgX3Njcm9sbCA9IF9wb3B1cC5wZXJmZWN0U2Nyb2xsYmFyKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYoIF9zaG93VHlwZSA9PSAxICl7XG4gICAgICAgICAgICAgICAgICAgIF9wb3B1cC5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6ICdub25lJ1xuICAgICAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgICAgIF9wb3B1cC5zbGlkZURvd24oIDMwMCApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiggX3Nob3dUeXBlID09IDIgKSB7XG4gICAgICAgICAgICAgICAgICAgIF9wb3B1cC5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDAuMVxuICAgICAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgICAgIF9wb3B1cC5hbmltYXRlKCB7IG9wYWNpdHk6IDEgfSwgMzAwKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfcG9wdXAuZmluZCggJ2xpJyApLm9uKCB7XG4gICAgICAgICAgICAgICAgICAgICdjbGljayc6IGZ1bmN0aW9uKCBlICl7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSAkKCB0aGlzICkuaW5kZXgoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX29iai52YWwoIF9vYmouZmluZCggJ29wdGlvbicgKS5lcSggaW5kZXggKS5hdHRyKCAndmFsdWUnICkgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9vYmoudHJpZ2dlciggJ2NoYW5nZScgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9oaWRlUG9wdXAoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgfTtcblxuICAgICAgICAvL3B1YmxpYyBwcm9wZXJ0aWVzXG5cbiAgICAgICAgLy9wdWJsaWMgbWV0aG9kc1xuICAgICAgICBfc2VsZi5jaGVja09wZW5lZCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICByZXR1cm4gX29wZW5lZDtcbiAgICAgICAgfTtcbiAgICAgICAgX3NlbGYuY2xvc2UgPSBmdW5jdGlvbigpe1xuICAgICAgICAgIF9oaWRlUG9wdXAoKTtcbiAgICAgICAgfTtcblxuXG4gICAgICAgIF9jb25zdHJ1Y3RvcigpO1xuXG4gICAgfTtcblxufSApKCk7IiwiKCBmdW5jdGlvbigpe1xuXG4gICAgJChmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgJCgnLmNhdGVnb3J5X19maWx0ZXJzJykuZWFjaChmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgIG5ldyBGaWx0ZXJzKCAkKHRoaXMpICk7XG5cbiAgICAgICAgfSApO1xuXG4gICAgfSApO1xuXG4gICAgdmFyIEZpbHRlcnMgPSBmdW5jdGlvbiAob2JqKSB7XG5cbiAgICAgICAgLy9wcml2YXRlIHByb3BlcnRpZXNcbiAgICAgICAgdmFyIF9vYmogPSBvYmosXG4gICAgICAgICAgICBfYnRuID0gX29iai5maW5kKCcuY2F0ZWdvcnlfX2ZpbHRlcnMtaXRlbSBzcGFuJyksXG4gICAgICAgICAgICBfYnRuMiA9IF9vYmouZmluZCgnLmNhdGVnb3J5X19maWx0ZXJzLXRpdGxlJyksXG4gICAgICAgICAgICBfZmlsdGVycyA9IF9vYmouZmluZCgnLmNhdGVnb3J5X19maWx0ZXJzLWl0ZW1zJyksXG4gICAgICAgICAgICBfd2luZG93ID0gJCh3aW5kb3cpO1xuXG4gICAgICAgIC8vcHJpdmF0ZSBtZXRob2RzXG5cbiAgICAgICAgdmFyIF9hZGRFdmVudHMgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICBfYnRuLm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJJdGVtID0gJCh0aGlzKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQgPSBjdXJJdGVtLnBhcmVudCgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5leHRGaWx0ZXJzID0gY3VySXRlbS5uZXh0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBwYXJlbnQuaGFzQ2xhc3MoJ29wZW5lZCcpICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50LnJlbW92ZUNsYXNzKCdvcGVuZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXh0RmlsdGVycy5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ21pbi1oZWlnaHQnOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQuYWRkQ2xhc3MoJ29wZW5lZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5leHRGaWx0ZXJzLmNzcygge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbWluLWhlaWdodCc6IG5leHRGaWx0ZXJzLmZpbmQoJz5kaXYnKS5pbm5lckhlaWdodCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5leHRGaWx0ZXJzLmNzcygge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2hlaWdodCc6ICdhdXRvJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAzMTAgKVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgIF9idG4yLm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJJdGVtID0gJCh0aGlzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIGN1ckl0ZW0uaGFzQ2xhc3MoJ29wZW5lZCcpICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VySXRlbS5yZW1vdmVDbGFzcygnb3BlbmVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2ZpbHRlcnMuY3NzKCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtaW4taGVpZ2h0JzogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VySXRlbS5hZGRDbGFzcygnb3BlbmVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2ZpbHRlcnMuY3NzKCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtaW4taGVpZ2h0JzogX2ZpbHRlcnMuZmluZCgnPmRpdicpLmlubmVySGVpZ2h0KClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZmlsdGVycy5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdoZWlnaHQnOiAnYXV0bydcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgMzEwIClcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfYWRkRXZlbnRzKCk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIC8vcHVibGljIHByb3BlcnRpZXNcblxuICAgICAgICAvL3B1YmxpYyBtZXRob2RzXG5cbiAgICAgICAgX2luaXQoKTtcbiAgICB9O1xufSApKCk7Il19
